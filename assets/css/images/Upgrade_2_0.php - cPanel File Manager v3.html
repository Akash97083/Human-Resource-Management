<!DOCTYPE html>
<!-- saved from url=(0272)https://ajaira.website:2083/cpsess5508744649/frontend/paper_lantern/filemanager/editit.html?file=Upgrade_2_0.php&fileop=&dir=%2Fhome%2Fajaira%2Fpublic_html%2Fpmnew%2Fwp-content%2Fplugins%2Fpm%2Fcore%2FUpgrades&dirop=&charset=&file_charset=_DETECT_&baseurl=&basedir=&edit=1 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Upgrade_2_0.php - cPanel File Manager v3</title>
        
        <link rel="stylesheet" type="text/css" href="./Upgrade_2_0.php - cPanel File Manager v3_files/bootstrap.min.css">
        
        <link rel="stylesheet" type="text/css" href="./Upgrade_2_0.php - cPanel File Manager v3_files/open_sans.min.css">
        <link rel="stylesheet" type="text/css" href="./Upgrade_2_0.php - cPanel File Manager v3_files/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="./Upgrade_2_0.php - cPanel File Manager v3_files/tree_styles2_optimized.css">

        <script type="text/javascript" src="./Upgrade_2_0.php - cPanel File Manager v3_files/utilities_container.js"></script>
        <script type="text/javascript" src="./Upgrade_2_0.php - cPanel File Manager v3_files/cpanel-all-min.js"></script>
        <script type="text/javascript" src="./Upgrade_2_0.php - cPanel File Manager v3_files/filemanager_editors_optimized.js"></script>
        
<link rel="stylesheet" type="text/css" href="./Upgrade_2_0.php - cPanel File Manager v3_files/ajaxapp-min.css">
<!--[if IE 6]>
<link rel="stylesheet" type="text/css" href="/cPanel_magic_revision_1475783731/cjt/css/ajaxapp_ie6.css" />
<![endif]-->


        <style type="text/css">
            html, body, #maintbl {
                height: 100%;
                width: 100%;
                margin: 0;
                padding: 0;
                background: none !important;
            }

            form { margin: 0 }

            #maintbl, #maintbl tr, #maintbl td {
                margin:0;
                padding:0;
                border-collapse: collapse;
                border: none;
            }

            .cjt_progress_overlay .bd {
                background: transparent;
            }

            /* Suppress inherited styles from global style sheets. */
            .yui-panel .hd,
            .yui-panel .bd,
            .yui-panel .ft {
                background-image: none;
                font-size: 100%;

            }
            .yui-panel .ft {
                background-color: #CCCCCC;
            }

            /* overrides from tree_styles2_optimized.css */
            p {
                line-height: normal;
            }
            .header {
                background: #333333;
                color: #FFFFFF;
                padding: 5px;
            }
            .button-group .default {
                background: none !important;
                padding: 0;
            }

            .action-buttons {
                text-align: right;
            }

            .editor-area {
                position: absolute !important;
                top: 94px;
                right: 0;
                left: 0;
                bottom: 20px;
                border: 1px solid #CCCCCC;
            }

            .editor-toolbar {
                padding-top: 5px;
                padding-bottom: 5px;
            }

            .editor-toolbar .fa-terminal {
                font-size: inherit;
            }

            .btn-group-ddl {
                padding: 1px;
            }

            .help-link {
                padding: 14px;
                display: block;
            }

            @media (max-width: 503px) {
                .editor-area {
                    top: 245px;
                }
                .action-buttons {
                    text-align: left;
                }
            }

            @media (min-width: 504px) and (max-width: 768px) {
                .editor-area {
                    top: 200px;
                }
            }

            @media (min-width: 769px) and (max-width: 1074px) {
                .editor-area {
                    top: 130px;
                }
            }
        </style>

        <!--[if IE]>
        <style type="text/css">
            #legacy_codewindow {
                width: 99.5%;
            }
        </style>
        <![endif]-->

    <style id="ace_editor.css">.ace_editor {position: relative;overflow: hidden;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
/*# sourceURL=ace/css/ace_editor.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style>    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }</style><script src="./Upgrade_2_0.php - cPanel File Manager v3_files/mode-php.js"></script><script src="./Upgrade_2_0.php - cPanel File Manager v3_files/theme-chrome.js"></script><style id="ace-chrome">.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-chrome */</style></head>
    <body class="nomargins yui-skin-sam"><iframe id="_yuiResizeMonitor" title="Text Resize Monitor" tabindex="-1" role="presentation" style="position: absolute; visibility: visible; background-color: transparent; border-width: 0px; width: 2em; height: 2em; left: 0px; top: -29px;" src="./Upgrade_2_0.php - cPanel File Manager v3_files/saved_resource.html"></iframe><div class="mask" id="yui-gen0_mask" style="z-index: 2499; height: 659px; width: 1217px; display: none;">&nbsp;</div><div class="yui-panel-container cjt-progress-overlay throbber cjt_progress_panel_container yui-overlay-hidden" id="yui-gen0_c" style="z-index: 2500; visibility: hidden; left: 471px; top: 321px; overflow: hidden;"><div id="yui-gen0" class="yui-module yui-overlay yui-panel cjt_progress_panel" style="visibility: inherit;"><input style="position: absolute; top: 1px; outline: 0px; margin: 0px; border: 0px; padding: 0px; height: 1px; width: 1px; z-index: -1; opacity: 0;"><button tabindex="-1" style="height: 1px; width: 1px; position: absolute; left: -10000em; opacity: 0;"></button><div class="bd" id="yui-gen1" style="border: 0px;"><div class="cjt-progress-overlay-body-liner"><div class="loader-tool"><div class="loader"></div></div><div class="cjt-progress-overlay-text-container"><span class="cjt-progress-overlay-text cjt-fading-text-field">Saving “Upgrade_2_0.php” …</span></div></div></div><input style="position: absolute; top: 1px; outline: 0px; margin: 0px; border: 0px; padding: 0px; height: 1px; width: 1px; z-index: -1; opacity: 0;"></div></div>
        <form action="javascript:void(0)" name="sform" onsubmit="loadfdata(&#39;sform_submit&#39;); return false;" class="form-inline">
            <table border="0" id="maintbl">
                <tbody><tr class="header">
                    <td style="padding: 5px">
                        <div class="row">
                            <div class="col-xs-12 col-md-8">
                                <label style="font-weight: 900; font-size:13px;">
                                    Editing:
                                    <input id="path" name="path" value="/home/ajaira/public_html/pmnew/wp-content/plugins/pm/core/Upgrades/Upgrade_2_0.php" class="form-control">
                                </label>
                                <label>Encoding:
                                    <select id="charset" name="charset" class="form-control">
                                    
                                        
                                            <option value="ansi_x3.110-1983">
                                                ansi_x3.110-1983
                                            </option>
                                        
                                            <option value="ansi_x3.4-1968">
                                                ansi_x3.4-1968
                                            </option>
                                        
                                            <option value="armscii-8">
                                                armscii-8
                                            </option>
                                        
                                            <option value="asmo_449">
                                                asmo_449
                                            </option>
                                        
                                            <option value="big5">
                                                big5
                                            </option>
                                        
                                            <option value="big5-hkscs">
                                                big5-hkscs
                                            </option>
                                        
                                            <option value="brf">
                                                brf
                                            </option>
                                        
                                            <option value="bs_4730">
                                                bs_4730
                                            </option>
                                        
                                            <option value="bs_viewdata">
                                                bs_viewdata
                                            </option>
                                        
                                            <option value="cp10007">
                                                cp10007
                                            </option>
                                        
                                            <option value="cp1125">
                                                cp1125
                                            </option>
                                        
                                            <option value="cp1250">
                                                cp1250
                                            </option>
                                        
                                            <option value="cp1253">
                                                cp1253
                                            </option>
                                        
                                            <option value="cp1254">
                                                cp1254
                                            </option>
                                        
                                            <option value="cp1255">
                                                cp1255
                                            </option>
                                        
                                            <option value="cp1256">
                                                cp1256
                                            </option>
                                        
                                            <option value="cp1257">
                                                cp1257
                                            </option>
                                        
                                            <option value="cp1258">
                                                cp1258
                                            </option>
                                        
                                            <option value="cp737">
                                                cp737
                                            </option>
                                        
                                            <option value="cp770">
                                                cp770
                                            </option>
                                        
                                            <option value="cp771">
                                                cp771
                                            </option>
                                        
                                            <option value="cp772">
                                                cp772
                                            </option>
                                        
                                            <option value="cp773">
                                                cp773
                                            </option>
                                        
                                            <option value="cp774">
                                                cp774
                                            </option>
                                        
                                            <option value="cp775">
                                                cp775
                                            </option>
                                        
                                            <option value="csa_z243.4-1985-1">
                                                csa_z243.4-1985-1
                                            </option>
                                        
                                            <option value="csa_z243.4-1985-2">
                                                csa_z243.4-1985-2
                                            </option>
                                        
                                            <option value="csa_z243.4-1985-gr">
                                                csa_z243.4-1985-gr
                                            </option>
                                        
                                            <option value="csn_369103">
                                                csn_369103
                                            </option>
                                        
                                            <option value="cwi">
                                                cwi
                                            </option>
                                        
                                            <option value="dec-mcs">
                                                dec-mcs
                                            </option>
                                        
                                            <option value="din_66003">
                                                din_66003
                                            </option>
                                        
                                            <option value="ds_2089">
                                                ds_2089
                                            </option>
                                        
                                            <option value="ebcdic-at-de">
                                                ebcdic-at-de
                                            </option>
                                        
                                            <option value="ebcdic-at-de-a">
                                                ebcdic-at-de-a
                                            </option>
                                        
                                            <option value="ebcdic-ca-fr">
                                                ebcdic-ca-fr
                                            </option>
                                        
                                            <option value="ebcdic-dk-no">
                                                ebcdic-dk-no
                                            </option>
                                        
                                            <option value="ebcdic-dk-no-a">
                                                ebcdic-dk-no-a
                                            </option>
                                        
                                            <option value="ebcdic-es">
                                                ebcdic-es
                                            </option>
                                        
                                            <option value="ebcdic-es-a">
                                                ebcdic-es-a
                                            </option>
                                        
                                            <option value="ebcdic-es-s">
                                                ebcdic-es-s
                                            </option>
                                        
                                            <option value="ebcdic-fi-se">
                                                ebcdic-fi-se
                                            </option>
                                        
                                            <option value="ebcdic-fi-se-a">
                                                ebcdic-fi-se-a
                                            </option>
                                        
                                            <option value="ebcdic-fr">
                                                ebcdic-fr
                                            </option>
                                        
                                            <option value="ebcdic-is-friss">
                                                ebcdic-is-friss
                                            </option>
                                        
                                            <option value="ebcdic-it">
                                                ebcdic-it
                                            </option>
                                        
                                            <option value="ebcdic-pt">
                                                ebcdic-pt
                                            </option>
                                        
                                            <option value="ebcdic-uk">
                                                ebcdic-uk
                                            </option>
                                        
                                            <option value="ebcdic-us">
                                                ebcdic-us
                                            </option>
                                        
                                            <option value="ecma-cyrillic">
                                                ecma-cyrillic
                                            </option>
                                        
                                            <option value="es">
                                                es
                                            </option>
                                        
                                            <option value="es2">
                                                es2
                                            </option>
                                        
                                            <option value="euc-jisx0213">
                                                euc-jisx0213
                                            </option>
                                        
                                            <option value="euc-jp">
                                                euc-jp
                                            </option>
                                        
                                            <option value="euc-jp-ms">
                                                euc-jp-ms
                                            </option>
                                        
                                            <option value="euc-kr">
                                                euc-kr
                                            </option>
                                        
                                            <option value="euc-tw">
                                                euc-tw
                                            </option>
                                        
                                            <option value="gb18030">
                                                gb18030
                                            </option>
                                        
                                            <option value="gb2312">
                                                gb2312
                                            </option>
                                        
                                            <option value="gb_1988-80">
                                                gb_1988-80
                                            </option>
                                        
                                            <option value="gbk">
                                                gbk
                                            </option>
                                        
                                            <option value="georgian-academy">
                                                georgian-academy
                                            </option>
                                        
                                            <option value="georgian-ps">
                                                georgian-ps
                                            </option>
                                        
                                            <option value="gost_19768-74">
                                                gost_19768-74
                                            </option>
                                        
                                            <option value="greek-ccitt">
                                                greek-ccitt
                                            </option>
                                        
                                            <option value="greek7">
                                                greek7
                                            </option>
                                        
                                            <option value="greek7-old">
                                                greek7-old
                                            </option>
                                        
                                            <option value="gsm03.38">
                                                gsm03.38
                                            </option>
                                        
                                            <option value="hp-greek8">
                                                hp-greek8
                                            </option>
                                        
                                            <option value="hp-roman8">
                                                hp-roman8
                                            </option>
                                        
                                            <option value="hp-roman9">
                                                hp-roman9
                                            </option>
                                        
                                            <option value="hp-thai8">
                                                hp-thai8
                                            </option>
                                        
                                            <option value="hp-turkish8">
                                                hp-turkish8
                                            </option>
                                        
                                            <option value="hz-gb-2312">
                                                hz-gb-2312
                                            </option>
                                        
                                            <option value="ibm037">
                                                ibm037
                                            </option>
                                        
                                            <option value="ibm038">
                                                ibm038
                                            </option>
                                        
                                            <option value="ibm1004">
                                                ibm1004
                                            </option>
                                        
                                            <option value="ibm1026">
                                                ibm1026
                                            </option>
                                        
                                            <option value="ibm1047">
                                                ibm1047
                                            </option>
                                        
                                            <option value="ibm1124">
                                                ibm1124
                                            </option>
                                        
                                            <option value="ibm1129">
                                                ibm1129
                                            </option>
                                        
                                            <option value="ibm1132">
                                                ibm1132
                                            </option>
                                        
                                            <option value="ibm1133">
                                                ibm1133
                                            </option>
                                        
                                            <option value="ibm1160">
                                                ibm1160
                                            </option>
                                        
                                            <option value="ibm1161">
                                                ibm1161
                                            </option>
                                        
                                            <option value="ibm1162">
                                                ibm1162
                                            </option>
                                        
                                            <option value="ibm1163">
                                                ibm1163
                                            </option>
                                        
                                            <option value="ibm1164">
                                                ibm1164
                                            </option>
                                        
                                            <option value="ibm256">
                                                ibm256
                                            </option>
                                        
                                            <option value="ibm273">
                                                ibm273
                                            </option>
                                        
                                            <option value="ibm274">
                                                ibm274
                                            </option>
                                        
                                            <option value="ibm275">
                                                ibm275
                                            </option>
                                        
                                            <option value="ibm277">
                                                ibm277
                                            </option>
                                        
                                            <option value="ibm278">
                                                ibm278
                                            </option>
                                        
                                            <option value="ibm280">
                                                ibm280
                                            </option>
                                        
                                            <option value="ibm281">
                                                ibm281
                                            </option>
                                        
                                            <option value="ibm284">
                                                ibm284
                                            </option>
                                        
                                            <option value="ibm285">
                                                ibm285
                                            </option>
                                        
                                            <option value="ibm290">
                                                ibm290
                                            </option>
                                        
                                            <option value="ibm297">
                                                ibm297
                                            </option>
                                        
                                            <option value="ibm420">
                                                ibm420
                                            </option>
                                        
                                            <option value="ibm423">
                                                ibm423
                                            </option>
                                        
                                            <option value="ibm424">
                                                ibm424
                                            </option>
                                        
                                            <option value="ibm437">
                                                ibm437
                                            </option>
                                        
                                            <option value="ibm500">
                                                ibm500
                                            </option>
                                        
                                            <option value="ibm850">
                                                ibm850
                                            </option>
                                        
                                            <option value="ibm851">
                                                ibm851
                                            </option>
                                        
                                            <option value="ibm852">
                                                ibm852
                                            </option>
                                        
                                            <option value="ibm855">
                                                ibm855
                                            </option>
                                        
                                            <option value="ibm856">
                                                ibm856
                                            </option>
                                        
                                            <option value="ibm857">
                                                ibm857
                                            </option>
                                        
                                            <option value="ibm860">
                                                ibm860
                                            </option>
                                        
                                            <option value="ibm861">
                                                ibm861
                                            </option>
                                        
                                            <option value="ibm862">
                                                ibm862
                                            </option>
                                        
                                            <option value="ibm863">
                                                ibm863
                                            </option>
                                        
                                            <option value="ibm864">
                                                ibm864
                                            </option>
                                        
                                            <option value="ibm865">
                                                ibm865
                                            </option>
                                        
                                            <option value="ibm866">
                                                ibm866
                                            </option>
                                        
                                            <option value="ibm866nav">
                                                ibm866nav
                                            </option>
                                        
                                            <option value="ibm868">
                                                ibm868
                                            </option>
                                        
                                            <option value="ibm869">
                                                ibm869
                                            </option>
                                        
                                            <option value="ibm870">
                                                ibm870
                                            </option>
                                        
                                            <option value="ibm871">
                                                ibm871
                                            </option>
                                        
                                            <option value="ibm874">
                                                ibm874
                                            </option>
                                        
                                            <option value="ibm875">
                                                ibm875
                                            </option>
                                        
                                            <option value="ibm880">
                                                ibm880
                                            </option>
                                        
                                            <option value="ibm891">
                                                ibm891
                                            </option>
                                        
                                            <option value="ibm903">
                                                ibm903
                                            </option>
                                        
                                            <option value="ibm904">
                                                ibm904
                                            </option>
                                        
                                            <option value="ibm905">
                                                ibm905
                                            </option>
                                        
                                            <option value="ibm918">
                                                ibm918
                                            </option>
                                        
                                            <option value="ibm922">
                                                ibm922
                                            </option>
                                        
                                            <option value="iec_p27-1">
                                                iec_p27-1
                                            </option>
                                        
                                            <option value="inis">
                                                inis
                                            </option>
                                        
                                            <option value="inis-8">
                                                inis-8
                                            </option>
                                        
                                            <option value="inis-cyrillic">
                                                inis-cyrillic
                                            </option>
                                        
                                            <option value="invariant">
                                                invariant
                                            </option>
                                        
                                            <option value="isiri-3342">
                                                isiri-3342
                                            </option>
                                        
                                            <option value="iso-8859-1">
                                                iso-8859-1
                                            </option>
                                        
                                            <option value="iso-8859-10">
                                                iso-8859-10
                                            </option>
                                        
                                            <option value="iso-8859-11">
                                                iso-8859-11
                                            </option>
                                        
                                            <option value="iso-8859-13">
                                                iso-8859-13
                                            </option>
                                        
                                            <option value="iso-8859-14">
                                                iso-8859-14
                                            </option>
                                        
                                            <option value="iso-8859-15">
                                                iso-8859-15
                                            </option>
                                        
                                            <option value="iso-8859-16">
                                                iso-8859-16
                                            </option>
                                        
                                            <option value="iso-8859-2">
                                                iso-8859-2
                                            </option>
                                        
                                            <option value="iso-8859-3">
                                                iso-8859-3
                                            </option>
                                        
                                            <option value="iso-8859-4">
                                                iso-8859-4
                                            </option>
                                        
                                            <option value="iso-8859-5">
                                                iso-8859-5
                                            </option>
                                        
                                            <option value="iso-8859-6">
                                                iso-8859-6
                                            </option>
                                        
                                            <option value="iso-8859-7">
                                                iso-8859-7
                                            </option>
                                        
                                            <option value="iso-8859-8">
                                                iso-8859-8
                                            </option>
                                        
                                            <option value="iso-8859-9">
                                                iso-8859-9
                                            </option>
                                        
                                            <option value="iso-8859-9e">
                                                iso-8859-9e
                                            </option>
                                        
                                            <option value="iso-ir-197">
                                                iso-ir-197
                                            </option>
                                        
                                            <option value="iso-ir-209">
                                                iso-ir-209
                                            </option>
                                        
                                            <option value="iso-ir-90">
                                                iso-ir-90
                                            </option>
                                        
                                            <option value="iso_10367-box">
                                                iso_10367-box
                                            </option>
                                        
                                            <option value="iso_10646">
                                                iso_10646
                                            </option>
                                        
                                            <option value="iso_11548-1">
                                                iso_11548-1
                                            </option>
                                        
                                            <option value="iso_2033-1983">
                                                iso_2033-1983
                                            </option>
                                        
                                            <option value="iso_5427">
                                                iso_5427
                                            </option>
                                        
                                            <option value="iso_5427-ext">
                                                iso_5427-ext
                                            </option>
                                        
                                            <option value="iso_5428">
                                                iso_5428
                                            </option>
                                        
                                            <option value="iso_646.basic">
                                                iso_646.basic
                                            </option>
                                        
                                            <option value="iso_646.irv">
                                                iso_646.irv
                                            </option>
                                        
                                            <option value="iso_6937">
                                                iso_6937
                                            </option>
                                        
                                            <option value="iso_6937-2-25">
                                                iso_6937-2-25
                                            </option>
                                        
                                            <option value="iso_6937-2-add">
                                                iso_6937-2-add
                                            </option>
                                        
                                            <option value="iso_8859-1,gl">
                                                iso_8859-1,gl
                                            </option>
                                        
                                            <option value="iso_8859-supp">
                                                iso_8859-supp
                                            </option>
                                        
                                            <option value="it">
                                                it
                                            </option>
                                        
                                            <option value="jis_c6220-1969-jp">
                                                jis_c6220-1969-jp
                                            </option>
                                        
                                            <option value="jis_c6220-1969-ro">
                                                jis_c6220-1969-ro
                                            </option>
                                        
                                            <option value="jis_c6229-1984-a">
                                                jis_c6229-1984-a
                                            </option>
                                        
                                            <option value="jis_c6229-1984-b">
                                                jis_c6229-1984-b
                                            </option>
                                        
                                            <option value="jis_c6229-1984-b-add">
                                                jis_c6229-1984-b-add
                                            </option>
                                        
                                            <option value="jis_c6229-1984-hand">
                                                jis_c6229-1984-hand
                                            </option>
                                        
                                            <option value="jis_c6229-1984-hand-add">
                                                jis_c6229-1984-hand-add
                                            </option>
                                        
                                            <option value="jis_c6229-1984-kana">
                                                jis_c6229-1984-kana
                                            </option>
                                        
                                            <option value="jis_x0201">
                                                jis_x0201
                                            </option>
                                        
                                            <option value="johab">
                                                johab
                                            </option>
                                        
                                            <option value="jus_i.b1.002">
                                                jus_i.b1.002
                                            </option>
                                        
                                            <option value="jus_i.b1.003-mac">
                                                jus_i.b1.003-mac
                                            </option>
                                        
                                            <option value="jus_i.b1.003-serb">
                                                jus_i.b1.003-serb
                                            </option>
                                        
                                            <option value="koi-8">
                                                koi-8
                                            </option>
                                        
                                            <option value="koi8-r">
                                                koi8-r
                                            </option>
                                        
                                            <option value="koi8-ru">
                                                koi8-ru
                                            </option>
                                        
                                            <option value="koi8-t">
                                                koi8-t
                                            </option>
                                        
                                            <option value="koi8-u">
                                                koi8-u
                                            </option>
                                        
                                            <option value="ks_c_5601-1987">
                                                ks_c_5601-1987
                                            </option>
                                        
                                            <option value="ksc5636">
                                                ksc5636
                                            </option>
                                        
                                            <option value="latin-greek">
                                                latin-greek
                                            </option>
                                        
                                            <option value="latin-greek-1">
                                                latin-greek-1
                                            </option>
                                        
                                            <option value="mac-centraleurope">
                                                mac-centraleurope
                                            </option>
                                        
                                            <option value="mac-cyrillic">
                                                mac-cyrillic
                                            </option>
                                        
                                            <option value="mac-is">
                                                mac-is
                                            </option>
                                        
                                            <option value="mac-sami">
                                                mac-sami
                                            </option>
                                        
                                            <option value="mac-uk">
                                                mac-uk
                                            </option>
                                        
                                            <option value="macintosh">
                                                macintosh
                                            </option>
                                        
                                            <option value="mik">
                                                mik
                                            </option>
                                        
                                            <option value="msz_7795.3">
                                                msz_7795.3
                                            </option>
                                        
                                            <option value="nats-dano">
                                                nats-dano
                                            </option>
                                        
                                            <option value="nats-dano-add">
                                                nats-dano-add
                                            </option>
                                        
                                            <option value="nats-sefi">
                                                nats-sefi
                                            </option>
                                        
                                            <option value="nats-sefi-add">
                                                nats-sefi-add
                                            </option>
                                        
                                            <option value="nc_nc00-10">
                                                nc_nc00-10
                                            </option>
                                        
                                            <option value="nextstep">
                                                nextstep
                                            </option>
                                        
                                            <option value="nf_z_62-010">
                                                nf_z_62-010
                                            </option>
                                        
                                            <option value="nf_z_62-010_1973">
                                                nf_z_62-010_1973
                                            </option>
                                        
                                            <option value="ns_4551-1">
                                                ns_4551-1
                                            </option>
                                        
                                            <option value="ns_4551-2">
                                                ns_4551-2
                                            </option>
                                        
                                            <option value="pt">
                                                pt
                                            </option>
                                        
                                            <option value="pt154">
                                                pt154
                                            </option>
                                        
                                            <option value="pt2">
                                                pt2
                                            </option>
                                        
                                            <option value="rk1048">
                                                rk1048
                                            </option>
                                        
                                            <option value="sami">
                                                sami
                                            </option>
                                        
                                            <option value="sami-ws2">
                                                sami-ws2
                                            </option>
                                        
                                            <option value="sen_850200_b">
                                                sen_850200_b
                                            </option>
                                        
                                            <option value="sen_850200_c">
                                                sen_850200_c
                                            </option>
                                        
                                            <option value="shift_jis">
                                                shift_jis
                                            </option>
                                        
                                            <option value="shift_jisx0213">
                                                shift_jisx0213
                                            </option>
                                        
                                            <option value="t.101-g2">
                                                t.101-g2
                                            </option>
                                        
                                            <option value="t.61-7bit">
                                                t.61-7bit
                                            </option>
                                        
                                            <option value="t.61-8bit">
                                                t.61-8bit
                                            </option>
                                        
                                            <option value="tcvn5712-1">
                                                tcvn5712-1
                                            </option>
                                        
                                            <option value="tis-620">
                                                tis-620
                                            </option>
                                        
                                            <option value="tscii">
                                                tscii
                                            </option>
                                        
                                            <option value="us-ascii">
                                                us-ascii
                                            </option>
                                        
                                            <option value="utf-7">
                                                utf-7
                                            </option>
                                        
                                            <option value="utf-8" selected="">
                                                utf-8
                                            </option>
                                        
                                            <option value="videotex-suppl">
                                                videotex-suppl
                                            </option>
                                        
                                            <option value="viscii">
                                                viscii
                                            </option>
                                        
                                            <option value="windows-1251">
                                                windows-1251
                                            </option>
                                        
                                            <option value="windows-1252">
                                                windows-1252
                                            </option>
                                        
                                            <option value="windows-31j">
                                                windows-31j
                                            </option>
                                        
                                    
                                    </select>
                                </label>
                                <input type="button" onclick="loadfile(this);" class="btn btn-default" value="Re-open" id="btnReOpen">
                            </div>
                            <div class="col-xs-12 col-md-4 action-buttons">
                                <button type="button" class="btn btn-default" id="switch_editor_control" onclick="try {toggle_EditArea(this)} catch(e) {} return false" title="Switch to legacy editor.">Use legacy editor</button>
                                &nbsp;
                                <button type="submit" id="sform_submit" class="btn btn-primary" style="font-weight:bold">
                                    Save Changes
                                </button>
                                <input type="button" onclick="confirm_close(this);" class="btn btn-default" value="Close" id="btnClose">
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="show-ace-editor">
                    <td>
                        <div class="row">
                            <div class="col-xs-12 col-sm-4">
                                <a href="https://github.com/ajaxorg/ace/wiki/Default-Keyboard-Shortcuts" target="_blank" class="help-link">
                                    <span class="fa fa-external-link"></span>
                                    Keyboard shortcuts
                                </a>
                            </div>
                            <!-- Editor Toolbar -->
                            <div class="col-xs-12 col-sm-8">
                                <div class="btn-toolbar editor-toolbar" role="toolbar">
                                    <div class="btn-group" role="group">
                                        <button id="btnSearch" type="button" onclick="toolbarActions(&#39;search&#39;)" class="btn btn-default" title="Search">
                                            <i class="fa fa-search"></i>
                                        </button>
                                        <button id="btnGoto" type="button" onclick="toolbarActions(&#39;goto&#39;)" class="btn btn-default" title="Go to line.">
                                            <i class="fa fa-terminal"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group" role="group">
                                        <button id="btnUndo" type="button" onclick="toolbarActions(&#39;undo&#39;)" class="btn btn-default" title="Undo">
                                            <i class="fa fa-undo"></i>
                                        </button>
                                        <button id="btnRedo" type="button" onclick="toolbarActions(&#39;redo&#39;)" class="btn btn-default" title="Redo">
                                            <i class="fa fa-repeat"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group" role="group">
                                        <button id="btnLineWrap" type="button" onclick="toolbarActions(&#39;linewrap&#39;)" class="btn btn-default active" title="Wrap">
                                            <i class="fa fa-arrows-h"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group" role="group">
                                        <select id="ddlFontSizes" class="btn btn-default form-control btn-group-ddl">
                                        <option value="10">10px</option><option value="11">11px</option><option value="12">12px</option><option value="13">13px</option><option value="14">14px</option><option value="16">16px</option><option value="18">18px</option><option value="20">20px</option><option value="24">24px</option></select>
                                    </div>
                                    <div class="btn-group" role="group">
                                        <select id="ddlModes" class="btn btn-default form-control btn-group-ddl">
                                        <option value="abap">ABAP</option><option value="abc">ABC</option><option value="actionscript">ActionScript</option><option value="ada">ADA</option><option value="apache_conf">Apache Conf</option><option value="asciidoc">AsciiDoc</option><option value="assembly_x86">Assembly x86</option><option value="autohotkey">AutoHotKey</option><option value="batchfile">BatchFile</option><option value="bro">Bro</option><option value="c_cpp">C and C++</option><option value="c9search">C9Search</option><option value="cirru">Cirru</option><option value="clojure">Clojure</option><option value="cobol">Cobol</option><option value="coffee">CoffeeScript</option><option value="coldfusion">ColdFusion</option><option value="csharp">C#</option><option value="css">CSS</option><option value="curly">Curly</option><option value="d">D</option><option value="dart">Dart</option><option value="diff">Diff</option><option value="dockerfile">Dockerfile</option><option value="dot">Dot</option><option value="drools">Drools</option><option value="dummy">Dummy</option><option value="dummysyntax">DummySyntax</option><option value="eiffel">Eiffel</option><option value="ejs">EJS</option><option value="elixir">Elixir</option><option value="elm">Elm</option><option value="erlang">Erlang</option><option value="forth">Forth</option><option value="fortran">Fortran</option><option value="ftl">FreeMarker</option><option value="gcode">Gcode</option><option value="gherkin">Gherkin</option><option value="gitignore">Gitignore</option><option value="glsl">Glsl</option><option value="gobstones">Gobstones</option><option value="golang">Go</option><option value="groovy">Groovy</option><option value="haml">HAML</option><option value="handlebars">Handlebars</option><option value="haskell">Haskell</option><option value="haskell_cabal">Haskell Cabal</option><option value="haxe">haXe</option><option value="hjson">Hjson</option><option value="html">HTML</option><option value="html_elixir">HTML (Elixir)</option><option value="html_ruby">HTML (Ruby)</option><option value="ini">INI</option><option value="io">Io</option><option value="jack">Jack</option><option value="jade">Jade</option><option value="java">Java</option><option value="javascript">JavaScript</option><option value="json">JSON</option><option value="jsoniq">JSONiq</option><option value="jsp">JSP</option><option value="jsx">JSX</option><option value="julia">Julia</option><option value="kotlin">Kotlin</option><option value="latex">LaTeX</option><option value="less">LESS</option><option value="liquid">Liquid</option><option value="lisp">Lisp</option><option value="livescript">LiveScript</option><option value="logiql">LogiQL</option><option value="lsl">LSL</option><option value="lua">Lua</option><option value="luapage">LuaPage</option><option value="lucene">Lucene</option><option value="makefile">Makefile</option><option value="markdown">Markdown</option><option value="mask">Mask</option><option value="matlab">MATLAB</option><option value="maze">Maze</option><option value="mel">MEL</option><option value="mushcode">MUSHCode</option><option value="mysql">MySQL</option><option value="nix">Nix</option><option value="nsis">NSIS</option><option value="objectivec">Objective-C</option><option value="ocaml">OCaml</option><option value="pascal">Pascal</option><option value="perl">Perl</option><option value="pgsql">pgSQL</option><option value="php">PHP</option><option value="powershell">Powershell</option><option value="praat">Praat</option><option value="prolog">Prolog</option><option value="properties">Properties</option><option value="protobuf">Protobuf</option><option value="python">Python</option><option value="r">R</option><option value="razor">Razor</option><option value="rdoc">RDoc</option><option value="rhtml">RHTML</option><option value="rst">RST</option><option value="ruby">Ruby</option><option value="rust">Rust</option><option value="sass">SASS</option><option value="scad">SCAD</option><option value="scala">Scala</option><option value="scheme">Scheme</option><option value="scss">SCSS</option><option value="sh">SH</option><option value="sjs">SJS</option><option value="smarty">Smarty</option><option value="snippets">snippets</option><option value="soy_template">Soy Template</option><option value="space">Space</option><option value="sql">SQL</option><option value="sqlserver">SQLServer</option><option value="stylus">Stylus</option><option value="svg">SVG</option><option value="swift">Swift</option><option value="tcl">Tcl</option><option value="tex">Tex</option><option value="text">Text</option><option value="textile">Textile</option><option value="toml">Toml</option><option value="tsx">TSX</option><option value="twig">Twig</option><option value="typescript">Typescript</option><option value="vala">Vala</option><option value="vbscript">VBScript</option><option value="velocity">Velocity</option><option value="verilog">Verilog</option><option value="vhdl">VHDL</option><option value="wollok">Wollok</option><option value="xml">XML</option><option value="xquery">XQuery</option><option value="yaml">YAML</option><option value="django">Django</option></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td id="codewindow_container">
                        <!-- Editor -->
                        <div id="codewindow" class="show-ace-editor editor-area ace_editor ace-chrome ace_focus" style="font-size: 13px;"><textarea class="ace_text-input" wrap="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="opacity: 0; height: 17px; width: 7.80156px; left: 178.222px; top: 233px;"></textarea><div class="ace_gutter"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="margin-top: -5px; height: 577px; width: 65px;"><div class="ace_gutter-cell " style="height: 17px;">30</div><div class="ace_gutter-cell " style="height: 17px;">31</div><div class="ace_gutter-cell " style="height: 17px;">32</div><div class="ace_gutter-cell " style="height: 17px;">33</div><div class="ace_gutter-cell " style="height: 17px;">34</div><div class="ace_gutter-cell " style="height: 17px;">35</div><div class="ace_gutter-cell " style="height: 17px;">36</div><div class="ace_gutter-cell " style="height: 17px;">37</div><div class="ace_gutter-cell " style="height: 17px;">38</div><div class="ace_gutter-cell " style="height: 17px;">39</div><div class="ace_gutter-cell " style="height: 17px;">40</div><div class="ace_gutter-cell " style="height: 17px;">41</div><div class="ace_gutter-cell " style="height: 17px;">42<span class="ace_fold-widget ace_start ace_open" style="height: 17px;"></span></div><div class="ace_gutter-cell " style="height: 17px;">43</div><div class="ace_gutter-cell " style="height: 17px;">44</div><div class="ace_gutter-cell " style="height: 17px;">45</div><div class="ace_gutter-cell " style="height: 34px;">46</div><div class="ace_gutter-cell " style="height: 17px;">47</div><div class="ace_gutter-cell " style="height: 17px;">48</div><div class="ace_gutter-cell " style="height: 17px;">49<span class="ace_fold-widget ace_start ace_open" style="height: 17px;"></span></div><div class="ace_gutter-cell " style="height: 17px;">50</div><div class="ace_gutter-cell " style="height: 17px;">51</div><div class="ace_gutter-cell " style="height: 17px;">52</div><div class="ace_gutter-cell " style="height: 17px;">53<span class="ace_fold-widget ace_start ace_open" style="height: 17px;"></span></div><div class="ace_gutter-cell " style="height: 17px;">54</div><div class="ace_gutter-cell " style="height: 17px;">55</div><div class="ace_gutter-cell " style="height: 17px;">56</div><div class="ace_gutter-cell " style="height: 17px;">57</div><div class="ace_gutter-cell " style="height: 17px;">58</div><div class="ace_gutter-cell " style="height: 17px;">59<span class="ace_fold-widget ace_start ace_open" style="height: 17px;"></span></div><div class="ace_gutter-cell " style="height: 17px;">60</div><div class="ace_gutter-cell " style="height: 17px;">61</div><div class="ace_gutter-cell " style="height: 17px;">62</div></div><div class="ace_gutter-active-line" style="top: 233px; height: 17px;"></div></div><div class="ace_scroller" style="left: 65px; right: 0px; bottom: 0px;"><div class="ace_content" style="margin-top: -5px; width: 1135px; height: 577px; margin-left: 0px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 628.125px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div class="ace_active-line" style="height:17px;top:238px;left:0;right:0;"></div></div><div class="ace_layer ace_text-layer" style="padding: 0px 4px;"><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$action</span>        <span class="ace_keyword ace_operator">=</span> <span class="ace_string">'pm_db_migration_2_0'</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$pm_queue_data</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$milestons</span>     <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$discuss</span>       <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$tasks</span>         <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$task_lists</span>    <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$comments</span>      <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$taskParent</span>    <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">protected</span> <span class="ace_variable">$kanboard_section</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">[</span><span class="ace_paren ace_rparen">]</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">public</span> <span class="ace_variable">$isProcessRuning</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_constant ace_language">false</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    </div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">function</span> <span class="ace_identifier">__construct</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span> <span class="ace_paren ace_lparen">{</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    <span class="ace_support ace_class">parent</span><span class="ace_keyword ace_operator">::</span><span class="ace_identifier">__construct</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    <span class="ace_support ace_function">die</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">add_action</span><span class="ace_paren ace_lparen">(</span><span class="ace_string">'admin_notices'</span>, <span class="ace_keyword">array</span><span class="ace_paren ace_lparen">(</span> <span class="ace_variable">$this</span>, <span class="ace_string">'notification'</span> <span class="ace_paren ace_rparen">)</span> <span class="ace_paren ace_rparen">)</span>;</div></div><div class="ace_line_group" style="height: 34px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    <span class="ace_identifier">add_filter</span><span class="ace_paren ace_lparen">(</span> <span class="ace_string">'wp_pm_db_migration_2_0_cron_interval'</span>, <span class="ace_paren ace_lparen">[</span><span class="ace_variable">$this</span>, </div><div class="ace_line" style="height:17px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ace_string">'migration_schedule_time'</span><span class="ace_paren ace_rparen">]</span> <span class="ace_paren ace_rparen">)</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_paren ace_rparen">}</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">function</span> <span class="ace_identifier">migration_schedule_time</span><span class="ace_paren ace_lparen">(</span> <span class="ace_variable">$time</span> <span class="ace_paren ace_rparen">)</span> <span class="ace_paren ace_lparen">{</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    <span class="ace_support ace_function">return</span> <span class="ace_constant ace_numeric">1</span>;</div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_paren ace_rparen">}</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_comment ace_doc">/**</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span><span class="ace_comment ace_doc"> * task funciotn run on background over time</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span><span class="ace_comment ace_doc"> * comes form WP_Background_Process abstruct    </span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span><span class="ace_comment ace_doc"> * </span><span class="ace_comment ace_doc ace_tag">@param</span><span class="ace_comment ace_doc">   $item </span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span><span class="ace_comment ace_doc"> * </span><span class="ace_comment ace_doc ace_tag">@return</span><span class="ace_comment ace_doc"> </span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span><span class="ace_comment ace_doc"> */</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px">    <span class="ace_keyword">function</span> <span class="ace_identifier">task</span><span class="ace_paren ace_lparen">(</span> <span class="ace_variable">$item</span> <span class="ace_paren ace_rparen">)</span> <span class="ace_paren ace_lparen">{</span></div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    </div></div><div class="ace_line_group" style="height: 17px;"><div class="ace_line" style="height:17px"><span class="ace_indent-guide">    </span>    <span class="ace_variable">$type</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_support ace_function">empty</span><span class="ace_paren ace_lparen">(</span> <span class="ace_variable">$item</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">'type'</span><span class="ace_paren ace_rparen">]</span> <span class="ace_paren ace_rparen">)</span> ? <span class="ace_string">''</span> : <span class="ace_variable">$item</span><span class="ace_paren ace_lparen">[</span><span class="ace_string">'type'</span><span class="ace_paren ace_rparen">]</span>;</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer"><div class="ace_cursor" style="left: 113.222px; top: 238px; width: 7.80156px; height: 17px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 20px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 20px; height: 32768px;"></div></div><div class="ace_scrollbar ace_scrollbar-h" style="height: 20px; left: 65px; right: 0px; display: none;"><div class="ace_scrollbar-inner" style="height: 20px; width: 1135px;"></div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;"></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div>
                        <textarea id="legacy_codewindow" class="codepress " style="visibility:hidden" wrap="soft" name="page"></textarea>
                    </td>
                </tr>
            </tbody></table>
        </form>

        <script type="text/plain" id="general_encoding_changed_template">
            <p>
                The system was unable to save your document in “{old_charset}” encoding. Most likely, your document contains characters incompatible with “{old_charset}”.
            </p>

            <p>
                cPanel has upgraded your document to “{new_charset}” encoding. Please verify that the file opens correctly in your application.
            </p>

            <p>
                To learn more about file encoding, visit <a href="https://go.cpanel.net/encoding">https://go.cpanel.net/encoding</a>.
            </p>
        </script>

        

<img src="./Upgrade_2_0.php - cPanel File Manager v3_files/progress_bar.gif" class="preloadedImage">
<img src="./Upgrade_2_0.php - cPanel File Manager v3_files/check.png" class="preloadedImage">

<script id="cjt_error_dialog_template" type="text/plain">
<div class="error_notice">{error_html}</div>
</script>

<script id="cjt_http_error_dialog_template" type="text/plain">
<div class="error_notice http_error_notice">
    <div class="http_status">{status}: {status_text_html}</div>
    <div><a href="javascript:void(0)" class="http_error_details_link">Show/Hide Details</a></div>
    <div class="cjt_error_details" style="display:none">
        <div class="url">URL ({method}):<pre>{url_html}</pre></div>
        <div class="post">Body: <pre>{post_html}</pre></div>
        <div class="response">Response:<pre>{response_html}</pre></div>
    </div>
</div>
</script>

<script>
CPANEL.application = "cpaneld";
YAHOO.lang.augmentObject( CPANEL.Locale.prototype.LEXICON, {"OK":"OK","Proceed":"Proceed","An unknown error occurred.":"An unknown error occurred.","HTTP ERROR":"HTTP ERROR","ERROR":"ERROR","Notice":"Notice","Success!":"Success!","Processing …":"Processing …","Error":"Error","Cancel":"Cancel"} );
</script>

<script src="./Upgrade_2_0.php - cPanel File Manager v3_files/ajaxapp-min.js"></script>


        <script type="text/javascript">
            var savedContent = "";
            var CHARSET = document.sform.charset.value;
            var USE_LEGACY_EDITOR = (0) ? true : false;
            if ( !window.LEXICON ) {
                LEXICON = {};
            }

            LEXICON.charset_changed = "Character Encoding Change";
            LEXICON.confirm_close   = "You have unsaved changes. Are you sure you want to close this window?";
            LEXICON.reloading       = "Reloading…";

            function loadfile(clicked_el) {
                var isFileEdited = false;
                if(ace_editor){
                    isFileEdited = !ace_editor.getSession().getUndoManager().isClean();
                }

                if(isFileEdited){
                    var sure = confirm("Are you sure you wish to open a new file? You will lose any changes you have made.");
                    if (!sure) {
                        return;
                    }
                }

                var filen = document.sform.path.value;
                var fpath = filen.split('/');;
                var filename = fpath.pop();
                var dir = fpath.join('/');
                var sdir = encodeURIComponent(dir);
                var sfilename = encodeURIComponent(filename);
                var charset = document.getElementById('charset').value;

                var pp = new CPANEL.ajax.Progress_Panel( DOM.generateId(), {
                    status_html : "Reloading…",
                    effect: CPANEL.ajax.FADE_MODAL
                } );

                if (clicked_el) {
                    pp.show_from_source(clicked_el);
                }
                else {
                    pp.show();
                }
                var tt_value = (USE_LEGACY_EDITOR) ? 1 : 0;
                document.location.href="?dir=" + sdir + "&file=" + sfilename + '&file_charset=' + charset + '&use_legacy_editor=' + tt_value;
                // update the title
                document.title = filename.replace(/\n|\r/, "").html_encode() + " - cPanel File Manager v3"
            }

            var LAST_NOTICE = null;

            function loadfdata(clicked_el) {
                var path     = DOM.get("path");
                var changedContent = "";
                var isFileEdited = true;
                if(USE_LEGACY_EDITOR){
                    changedContent = editAreaLoader.getValue(editAreaEl);
                } else {
                    var aceSession = ace_editor.getSession();
                    changedContent = aceSession.getValue();
                }

                if ( changedContent === savedContent && path.value === path.defaultValue ) {
                    isFileEdited = false;
                }

                if(!isFileEdited) {
                    LAST_NOTICE = new CPANEL.ajax.Dynamic_Notice({content:"You have made no changes to save.", level:"info", replaces:LAST_NOTICE});
                    return;
                }

                var match = path.value.match(/^(.+)\/([^\/]+)$/);
                if ( !match ) {
                    LAST_NOTICE = new CPANEL.ajax.Dynamic_Notice({content:"Invalid path.", level:"error", replaces:LAST_NOTICE});
                    return;
                }

                var api_params = {
                    module:   "Fileman",
                    func:     "savefile",
                    data:     {
                        dir:           match[1],
                        filename:      match[2],
                        content:       changedContent,
                        utf8_fallback: 1,
                        charset:       CHARSET
                    },
                    progress_panel: {
                        zIndex:      2500,
                        show_status: true,
                        source_el:   clicked_el,
                        status_html: "Saving “{the_file}” …".replace('{the_file}',match[2].html_encode()),
                        success_notice_options: { replaces:LAST_NOTICE },
                        before_success: function(result) {
                            savedContent = (USE_LEGACY_EDITOR) ? editAreaLoader.getValue(editAreaEl) : ace_editor.getValue();
                            return check_for_encoding_change.call(
                                this,
                                CPANEL.ajax.templates.general_encoding_changed_template,
                                result.cpanel_data
                            );
                        }
                    },
                    callback: {
                        success: function() { LAST_NOTICE = req.notice }
                    }
                };

                var req = CPANEL.api( api_params );

                return false;
            }
        </script>

        <script type="text/javascript" charset="utf-8" src="./Upgrade_2_0.php - cPanel File Manager v3_files/ace.js">
        </script>
        <script type="text/javascript" charset="utf-8" src="./Upgrade_2_0.php - cPanel File Manager v3_files/ext-modelist.js">
        </script>
        <script type="text/javascript" src="./Upgrade_2_0.php - cPanel File Manager v3_files/edit_area_full.js"></script>
        <script type="text/javascript" src="./Upgrade_2_0.php - cPanel File Manager v3_files/edit_area_resizer.js"></script>

        <script type="text/javascript" src="./Upgrade_2_0.php - cPanel File Manager v3_files/jquery-3.2.0.min.js"></script>
        <script>
        
        var file_content = "&lt;?php\nnamespace WeDevs\\PM\\Core\\Upgrades;\nuse WP_Background_Process;\nuse WP_Query;\nuse WeDevs\\PM\\Project\\Models\\Project;\nuse WeDevs\\PM\\Task\\Models\\Task;\nuse WeDevs\\PM\\User\\Models\\User_Role;\nuse WeDevs\\PM\\Milestone\\Models\\Milestone;\nuse WeDevs\\PM\\Common\\Models\\Meta;\nuse WeDevs\\PM\\Common\\Models\\Board;\nuse WeDevs\\PM\\Common\\Models\\Boardable;\nuse WeDevs\\PM\\Common\\Models\\Assignee;\nuse WeDevs\\PM\\File\\Models\\File;\nuse WeDevs\\PM\\Comment\\Models\\Comment;\nuse WeDevs\\PM\\Settings\\Models\\Settings;\nuse WeDevs\\PM\\Category\\Models\\Category;\nuse WeDevs\\PM\\Activity\\Models\\Activity;\nuse WeDevs\\PM_Pro\\Modules\\time_tracker\\src\\Models\\Time_Tracker;\nuse WeDevs\\PM_Pro\\Modules\\Gantt\\src\\Models\\Gantt;\nuse WeDevs\\PM_Pro\\Modules\\invoice\\src\\Models\\Invoice;\n\n/**\n*   Upgrade project manager 2.0     \n*/\nclass Upgrade_2_0 extends WP_Background_Process\n{\n    /**\n     * @var string\n     */\n    protected $action        = &#39;pm_db_migration_2_0&#39;;\n    protected $pm_queue_data = [];\n    protected $milestons     = [];\n    protected $discuss       = [];\n    protected $tasks         = [];\n    protected $task_lists    = [];\n    protected $comments      = [];\n    protected $taskParent    = [];\n    protected $kanboard_section = [];\n\n    public $isProcessRuning = false;\n    \n    function __construct() {\n        parent::__construct();\n        \n        add_action(&#39;admin_notices&#39;, array( $this, &#39;notification&#39; ) );\n        add_filter( &#39;wp_pm_db_migration_2_0_cron_interval&#39;, [$this, &#39;migration_schedule_time&#39;] );\n    }\n\n    function migration_schedule_time( $time ) {\n        return 1;\n    }\n\n    /**\n     * task funciotn run on background over time\n     * comes form WP_Background_Process abstruct    \n     * @param   $item \n     * @return \n     */\n    function task( $item ) {\n        \n        $type = empty( $item[&#39;type&#39;] ) ? &#39;&#39; : $item[&#39;type&#39;];\n\n        switch ( $type ) {\n            case &#39;project&#39;:\n                $this-&gt;upgrade_projects($item[&#39;id&#39;]);\n                break;\n\n            case &#39;milestone&#39;:\n                $this-&gt;milestons[$item[&#39;post&#39;][&#39;ID&#39;]] = $this-&gt;create_milestone( $item[&#39;post&#39;], $item[&#39;newProjectID&#39;] );\n                break;\n\n            case &#39;discuss&#39;:\n                $new_discuss = $this-&gt;create_discuss( $item[&#39;post&#39;], $item[&#39;newProjectID&#39;] );\n                $this-&gt;discuss[$item[&#39;post&#39;][&#39;ID&#39;]] = $new_discuss;\n                $this-&gt;get_comments( [$item[&#39;post&#39;][&#39;ID&#39;] =&gt; $new_discuss], $item[&#39;newProjectID&#39;], &#39;discussion_board&#39; );\n                $this-&gt;pm_update_queue();\n                break;\n\n            case &#39;task&#39;:\n\n                $new_task_id = $this-&gt;create_task( \n                    $item[&#39;post&#39;], \n                    $item[&#39;newProjectID&#39;],  \n                    $item[&#39;listitems&#39;], \n                    $item[&#39;list&#39;],  \n                    $item[&#39;parent&#39;], \n                    $item[&#39;old_project_id&#39;] \n                );\n                \n                $this-&gt;tasks[$item[&#39;post&#39;][&#39;ID&#39;]] = $new_task_id;\n\n                $this-&gt;get_subtask( $item[&#39;id&#39;], $new_task_id, $item[&#39;newProjectID&#39;], $item[&#39;listitems&#39;] );\n                $this-&gt;get_time_tracker( $item[&#39;old_project_id&#39;], $item[&#39;newProjectID&#39;], $item[&#39;listitems&#39;], [$item[&#39;post&#39;][&#39;ID&#39;] =&gt; $new_task_id] );\n                $this-&gt;set_kanboard_task( [$item[&#39;post&#39;][&#39;ID&#39;] =&gt; $new_task_id], $item );\n                $this-&gt;get_comments( [$item[&#39;post&#39;][&#39;ID&#39;] =&gt; $new_task_id], $item[&#39;newProjectID&#39;], &#39;task&#39; );\n                $this-&gt;pm_update_queue();\n                break;\n\n            case &#39;task_list&#39;:\n                $new_list_id = $this-&gt;create_task_list( $item[&#39;post&#39;], $item[&#39;newProjectID&#39;] );\n                $this-&gt;task_lists[$item[&#39;post&#39;][&#39;ID&#39;]] = $new_list_id;\n                $this-&gt;get_tasks( $item[&#39;oldProjectId&#39;], $item[&#39;newProjectID&#39;], [$item[&#39;post&#39;][&#39;ID&#39;] =&gt; $new_list_id] );\n\n                $this-&gt;get_comments( [$item[&#39;post&#39;][&#39;ID&#39;] =&gt; $new_list_id], $item[&#39;newProjectID&#39;], &#39;task_list&#39; );\n                $this-&gt;pm_update_queue();\n                break;\n\n            case &#39;comment&#39;:\n                $this-&gt;comments[$item[&#39;comment&#39;][&#39;comment_ID&#39;]] = $this-&gt;create_comments( $item[&#39;comment&#39;], $item[&#39;newProjectID&#39;], $item[&#39;commentable_type&#39;], $item[&#39;id&#39;] );\n                break;\n            \n            case &#39;activity&#39;:\n                $this-&gt;created_activity( $item[&#39;activity&#39;], $item[&#39;resource_id&#39;], $item[&#39;resource_type&#39;], $item[&#39;meta&#39;], $item[&#39;newProjectId&#39;] );\n                break;\n\n            case &#39;time_tracker&#39;:\n                $this-&gt;create_time_tracker($item);\n                break;\n\n            case &#39;subtask&#39;:\n                $this-&gt;create_subtask( $item );\n                break;\n            \n            default:\n                # code...\n                break;\n        }\n     \n        return false;\n    }\n\n    function set_kanboard_task( $tasks, $item ) {\n        if( is_array( $tasks ) &amp;&amp; !empty( $tasks ) ) {\n            foreach ( $tasks as $oldTaskId =&gt; $newTaskId ) {\n                $section_id = get_post_meta( $oldTaskId, &#39;_section_id&#39;, true );\n                $order = get_post_meta( $oldTaskId, &#39;_kanboard_order&#39;, true );\n\n                if ( empty( $section_id ) ){\n                    continue ;\n                }\n\n                $this-&gt;save_object( new Boardable, [\n                    &#39;board_id&#39;       =&gt; $this-&gt;kanboard_section[$item[&#39;newProjectID&#39;]][$section_id],\n                    &#39;board_type&#39;     =&gt; &#39;kanboard&#39;,\n                    &#39;boardable_id&#39;   =&gt; $newTaskId,\n                    &#39;boardable_type&#39; =&gt; &#39;task&#39;,\n                    &#39;order&#39;          =&gt; $order,\n                    &#39;created_by&#39;     =&gt; $item[&#39;post&#39;][&#39;post_author&#39;],\n                    &#39;updated_by&#39;     =&gt; $item[&#39;post&#39;][&#39;post_author&#39;],\n                    &#39;created_at&#39;     =&gt; $item[&#39;post&#39;][&#39;post_date&#39;],\n                    &#39;updated_at&#39;     =&gt; $item[&#39;post&#39;][&#39;post_modified&#39;],\n                ] ); \n            }\n        }\n    }\n\n    function get_subtask( $old_task_id, $new_task_id, $new_project_id, $listitems ) {\n        global $wpdb;\n        $old_sub_tasks = $wpdb-&gt;get_results( &quot;SELECT * FROM {$wpdb-&gt;posts} WHERE post_parent={$old_task_id} AND post_status=&#39;publish&#39;&quot;, ARRAY_A );\n        $new_list_id   = reset( $listitems );\n        \n        foreach ( $old_sub_tasks as $key =&gt; $subtask ) {\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;        =&gt; &#39;subtask&#39;,\n                &#39;title&#39;       =&gt; $subtask[&#39;post_title&#39;],\n                &#39;description&#39; =&gt; $subtask[&#39;post_content&#39;],\n                &#39;status&#39;      =&gt; get_post_meta( $subtask[&#39;ID&#39;], &#39;_completed&#39;, true),\n                &#39;project_id&#39;  =&gt; $new_project_id, \n                &#39;start_at&#39;    =&gt; get_post_meta( $subtask[&#39;ID&#39;], &#39;_start&#39;, true),\n                &#39;due_date&#39;    =&gt; get_post_meta( $subtask[&#39;ID&#39;], &#39;_due&#39;, true),\n                &#39;parent_id&#39;   =&gt; $new_task_id,\n                &#39;created_by&#39;  =&gt; $subtask[&#39;post_author&#39;],\n                &#39;updated_by&#39;  =&gt; $subtask[&#39;post_author&#39;],\n                &#39;created_at&#39;  =&gt; $subtask[&#39;post_date&#39;],\n                &#39;updated_at&#39;  =&gt; $subtask[&#39;post_modified&#39;],\n                &#39;board_id&#39;    =&gt; $new_list_id,\n                &#39;menu_order&#39;  =&gt; $subtask[&#39;menu_order&#39;],\n                &#39;subtask&#39;     =&gt; $subtask\n            ];\n        }\n    }\n\n    function create_subtask( $item ) {\n        $new_sub_task = $this-&gt;save_object( \n            new Task,\n            [\n                &#39;title&#39;       =&gt; $item[&#39;title&#39;],\n                &#39;description&#39; =&gt; $item[&#39;description&#39;],\n                &#39;status&#39;      =&gt; $item[&#39;status&#39;],\n                &#39;project_id&#39;  =&gt; $item[&#39;project_id&#39;], \n                &#39;start_at&#39;    =&gt; $item[&#39;start_at&#39;],\n                &#39;due_date&#39;    =&gt; $item[&#39;due_date&#39;],\n                &#39;parent_id&#39;   =&gt; $item[&#39;parent_id&#39;],\n                &#39;created_by&#39;  =&gt; $item[&#39;created_by&#39;],\n                &#39;updated_by&#39;  =&gt; $item[&#39;updated_by&#39;],\n                &#39;created_at&#39;  =&gt; $item[&#39;created_at&#39;],\n                &#39;updated_at&#39;  =&gt; $item[&#39;updated_at&#39;],\n            ]\n        );\n\n        $this-&gt;save_object( new Boardable, [\n            &#39;board_id&#39;       =&gt; $item[&#39;board_id&#39;],\n            &#39;board_type&#39;     =&gt; &#39;task_list&#39;,\n            &#39;boardable_id&#39;   =&gt; $new_sub_task-&gt;id,\n            &#39;boardable_type&#39; =&gt; &#39;sub_task&#39;,\n            &#39;order&#39;          =&gt; $item[&#39;menu_order&#39;],\n            &#39;created_by&#39;     =&gt; $item[&#39;created_by&#39;],\n            &#39;updated_by&#39;     =&gt; $item[&#39;updated_by&#39;],\n            &#39;created_at&#39;     =&gt; $item[&#39;created_at&#39;],\n            &#39;updated_at&#39;     =&gt; $item[&#39;updated_at&#39;],\n        ] );\n\n        $this-&gt;add_assignee( $new_sub_task, $item[&#39;subtask&#39;][&#39;ID&#39;] );\n\n    }\n\n    function migrate_file( $item ) {\n        $comments = [];\n        \n        $newFile = $this-&gt;add_file( [\n            &#39;fileable_id&#39;   =&gt; $item[&#39;fileable_id&#39;],\n            &#39;fileable_type&#39; =&gt; $item[&#39;fileable_type&#39;],\n            &#39;parent&#39;        =&gt; $item[&#39;parent&#39;],\n            &#39;type&#39;          =&gt; $item[&#39;file_type&#39;],\n            &#39;attachment_id&#39; =&gt; $item[&#39;attachment_id&#39;],\n            &#39;project_id&#39;    =&gt; $item[&#39;project_id&#39;],\n            &#39;created_by&#39;    =&gt; $item[&#39;created_by&#39;],\n            &#39;updated_by&#39;    =&gt; $item[&#39;updated_by&#39;],\n            &#39;created_at&#39;    =&gt; $item[&#39;created_at&#39;],\n            &#39;updated_at&#39;    =&gt; $item[&#39;updated_at&#39;],\n        ] );\n\n        if( $item[&#39;file&#39;][&#39;post_id&#39;] ){\n            $meta = $this-&gt;get_doc_meta( $item[&#39;file&#39;][&#39;post_id&#39;], $newFile-&gt;id, $item[&#39;project_id&#39;] );\n            $comments[$item[&#39;file&#39;][&#39;post_id&#39;]] = $newFile-&gt;id;\n        } elseif ( $item[&#39;file&#39;][&#39;attachment_id&#39;] ) {\n            $comments[$item[&#39;file&#39;][&#39;attachment_id&#39;]] = $newFile-&gt;id;\n        }\n\n        $fileArr[$item[&#39;file&#39;][&#39;id&#39;]] = $newFile-&gt;id;\n        $meta[&#39;private&#39;]      = $item[&#39;file&#39;][&#39;private&#39;] == &#39;yes&#39; ? 1 : 0;\n\n        if ( !empty( $item[&#39;file&#39;][&#39;dir_name&#39;] ) ){\n            $meta[&#39;title&#39;]   = $item[&#39;file&#39;][&#39;dir_name&#39;];\n        }\n\n        $this-&gt;add_meta( $meta, $newFile, $item[&#39;project_id&#39;], &#39;file&#39; );\n\n        $this-&gt;set_post_attachment( $comments, $item[&#39;project_id&#39;] );\n        $this-&gt;get_comments( $comments, $item[&#39;project_id&#39;], &#39;file&#39; );\n        $this-&gt;get_revision( $comments, $item[&#39;project_id&#39;] );\n    }\n\n    function get_file( $OldProjectId, $newProjectID ) {\n        if ( !$OldProjectId ){\n            return ;\n        }\n        global $wpdb;\n        $table    = $wpdb-&gt;prefix . &#39;cpm_file_relationship&#39;;\n        $files    = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT * FROM {$table} WHERE project_id=%d ORDER BY `id` ASC&quot;, $OldProjectId ), ARRAY_A );\n        $fileArr  = [];\n        $comments = [];\n   \n        foreach ( $files as $file ) {\n            $metas = [];\n            $parent  = !empty( $fileArr[$file[&#39;parent_id&#39;]] ) ? $fileArr[$file[&#39;parent_id&#39;]]: 0;\n            if ( $file[&#39;is_dir&#39;] == 1 ) {\n                $type = &#39;folder&#39;;\n            } else if ( $file[&#39;type&#39;] == &#39;doc&#39; ) {\n                $type = &#39;doc&#39;;\n            } else if ( $file[&#39;type&#39;] == &#39;google_doc&#39;) {\n                $type = &#39;link&#39;;\n            } else {\n                $type = &#39;pro_file&#39;;\n            }\n            \n            // $this-&gt;pm_queue_data[] = [\n            //     &#39;type&#39;          =&gt; &#39;file&#39;,\n            //     &#39;fileable_id&#39;   =&gt; null,\n            //     &#39;fileable_type&#39; =&gt; &#39;file&#39;,\n            //     &#39;parent&#39;        =&gt; $parent,\n            //     &#39;file_type&#39;     =&gt; $type,\n            //     &#39;attachment_id&#39; =&gt; $file[&#39;attachment_id&#39;],\n            //     &#39;project_id&#39;    =&gt; $newProjectID,\n            //     &#39;created_by&#39;    =&gt; $file[&#39;created_by&#39;],\n            //     &#39;updated_by&#39;    =&gt; $file[&#39;created_by&#39;],\n            //     &#39;created_at&#39;    =&gt; $file[&#39;created_at&#39;],\n            //     &#39;updated_at&#39;    =&gt; $file[&#39;updated_at&#39;],\n            //     &#39;file&#39;          =&gt; $file\n            // ];\n\n            $newFile = $this-&gt;add_file( [\n                &#39;fileable_id&#39;   =&gt; null,\n                &#39;fileable_type&#39; =&gt; &#39;file&#39;,\n                &#39;parent&#39;        =&gt; $parent,\n                &#39;type&#39;          =&gt; $type,\n                &#39;attachment_id&#39; =&gt; $file[&#39;attachment_id&#39;],\n                &#39;project_id&#39;    =&gt; $newProjectID,\n                &#39;created_by&#39;    =&gt; $file[&#39;created_by&#39;],\n                &#39;updated_by&#39;    =&gt; $file[&#39;created_by&#39;],\n                &#39;created_at&#39;    =&gt; $file[&#39;created_at&#39;],\n                &#39;updated_at&#39;    =&gt; $file[&#39;updated_at&#39;],\n            ] );\n\n            if( $file[&#39;post_id&#39;] ){\n                $meta = $this-&gt;get_doc_meta( $file[&#39;post_id&#39;], $newFile-&gt;id, $newProjectID );\n                $comments[$file[&#39;post_id&#39;]] = $newFile-&gt;id;\n            }elseif ( $file[&#39;attachment_id&#39;] ) {\n                $comments[$file[&#39;attachment_id&#39;]] = $newFile-&gt;id;\n            }\n\n            $fileArr[$file[&#39;id&#39;]] = $newFile-&gt;id;\n            $meta[&#39;private&#39;]      = $file[&#39;private&#39;] == &#39;yes&#39; ? 1 : 0;\n\n            if ( !empty( $file[&#39;dir_name&#39;] ) ){\n                $meta[&#39;title&#39;]   = $file[&#39;dir_name&#39;];\n            }\n\n            $this-&gt;add_meta( $meta, $newFile, $newProjectID, &#39;file&#39; );\n        }\n\n        //$this-&gt;save()-&gt;dispatch();\n\n        $this-&gt;set_post_attachment( $comments, $newProjectID );\n        $this-&gt;get_comments( $comments, $newProjectID, &#39;file&#39; );\n        $this-&gt;get_revision( $comments, $newProjectID );\n\n        return $fileArr;\n        \n    }\n\n    function get_doc_meta( $post_id, $docid, $newProjectID ) {\n        if ( !$post_id ) {\n            return ;\n        }\n        global $wpdb;\n        $post = $wpdb-&gt;get_row( $wpdb-&gt;prepare( &quot;SELECT * FROM {$wpdb-&gt;posts} WHERE ID=%d&quot;, $post_id ) );\n        $meta = [];\n        $meta[&#39;title&#39;] = $post-&gt;post_title;\n        $meta[&#39;description&#39;] = $post-&gt;post_content;\n        if( !empty( $post-&gt;post_excerpt ) ){\n            $meta[&#39;url&#39;] = $post-&gt;post_excerpt;\n        }\n\n        return $meta;\n    }\n\n    function set_post_attachment( $ids, $newProjectID ) {\n        if( empty( $ids ) ){\n            return ;\n        }\n        global $wpdb;\n        $in        = implode(&#39;,&#39;, array_keys($ids));\n        $attachments = $wpdb-&gt;get_results( &quot;SELECT * FROM {$wpdb-&gt;posts} WHERE post_parent IN({$in}) and post_type=&#39;attachment&#39;&quot;, ARRAY_A);\n\n        foreach ( $attachments as $attachment ){\n            $this-&gt;add_file([\n                &#39;fileable_id&#39;   =&gt; $ids[$attachment[&#39;post_parent&#39;]],\n                &#39;fileable_type&#39; =&gt; &#39;file&#39;,\n                &#39;parent&#39;        =&gt; $ids[$attachment[&#39;post_parent&#39;]],\n                &#39;type&#39;          =&gt; &#39;doc&#39;,\n                &#39;attachment_id&#39; =&gt; $attachment[&quot;ID&quot;],\n                &#39;project_id&#39;    =&gt; $newProjectID,\n                &#39;created_by&#39;    =&gt; $attachment[&#39;post_author&#39;],\n                &#39;updated_by&#39;    =&gt; $attachment[&#39;post_author&#39;],\n                &#39;created_at&#39;    =&gt; $attachment[&#39;post_date&#39;],\n                &#39;updated_at&#39;    =&gt; $attachment[&#39;post_date&#39;],\n            ]);\n        }\n    }\n    \n    function get_revision( $ids, $newProjectID ) {\n        if( empty( $ids ) ){\n            return ;\n        }\n        global $wpdb;\n        $in        = implode(&#39;,&#39;, array_keys($ids));\n        $revisions = $wpdb-&gt;get_results( &quot;SELECT * FROM {$wpdb-&gt;posts} WHERE post_parent IN({$in}) and post_type=&#39;revision&#39;&quot;, ARRAY_A);\n        \n        foreach( $revisions as $revision ){\n            $meta=[];\n            $newFile = $this-&gt;add_file([\n                &#39;fileable_id&#39;   =&gt; null,\n                &#39;fileable_type&#39; =&gt; &#39;file&#39;,\n                &#39;parent&#39;        =&gt; $ids[$revision[&#39;post_parent&#39;]],\n                &#39;type&#39;          =&gt; &#39;revision&#39;,\n                &#39;attachment_id&#39; =&gt; null,\n                &#39;project_id&#39;    =&gt; $newProjectID,\n                &#39;created_by&#39;    =&gt; $revision[&#39;post_author&#39;],\n                &#39;updated_by&#39;    =&gt; $revision[&#39;post_author&#39;],\n                &#39;created_at&#39;    =&gt; $revision[&#39;post_date&#39;],\n                &#39;updated_at&#39;    =&gt; $revision[&#39;post_date&#39;],\n            ]);\n\n            $meta[&#39;title&#39;] = $revision[&#39;post_title&#39;];\n            $meta[&#39;description&#39;] = $revision[&#39;post_content&#39;];\n            if( !empty( $revision[&#39;post_excerpt&#39;] ) ){\n                $meta[&#39;url&#39;] = $revision [&#39;post_excerpt&#39;];\n            }\n\n            $this-&gt;add_meta( $meta, $newFile, $newProjectID, &#39;file&#39; );\n        }\n    }\n\n    /**\n     * Complete.\n     *\n     * Override if applicable, but ensure that the below actions are\n     * performed, or, call parent::complete().\n     */\n    protected function complete() {\n        $this-&gt;gantt_upgrate();\n\n        $porjects = get_site_option( &#39;pm_db_migration&#39;, [] );\n        \n        foreach ( $porjects  as $old_project_id =&gt; $new_project_id ) {\n            $this-&gt;get_invoice( $old_project_id, $new_project_id );\n        }\n        \n        // Unschedule the cron healthcheck.\n        $this-&gt;clear_scheduled_event();\n    }\n\n    /**\n     * retrive old project and push into new database\n     * @param  int $project_id \n     * @return Object             new Project model object\n     */\n    function create_project( $project_id ) {\n        global $wpdb;\n\n        if ( !$project_id &amp;&amp; !is_int( $project_id ) ) {\n            return;\n        }\n\n        $oldProject = $wpdb-&gt;get_row( $wpdb-&gt;prepare( &quot;SELECT * FROM $wpdb-&gt;posts WHERE ID=%d&quot;, $project_id ) );\n\n        $newProject = $this-&gt;save_object( new Project, [\n            &#39;title&#39;       =&gt; $oldProject-&gt;post_title,\n            &#39;description&#39; =&gt; $oldProject-&gt;post_content,\n            &#39;status&#39;      =&gt; get_post_meta($project_id, &#39;_project_active&#39;, true) == &#39;yes&#39; ? 0 : 1,\n            &#39;created_by&#39;  =&gt; $oldProject-&gt;post_author,\n            &#39;updated_by&#39;  =&gt; $oldProject-&gt;post_author,\n            &#39;created_at&#39;  =&gt; $oldProject-&gt;post_date,\n            &#39;updated_at&#39;  =&gt; $oldProject-&gt;post_modified,\n        ] );\n\n        //it should be execute after migrate only project\n        $this-&gt;get_kanboard( $project_id, $newProject);\n\n        $this-&gt;create_project_role( $project_id, $newProject-&gt;id, $oldProject-&gt;post_author );\n        $this-&gt;get_milestones( $project_id, $newProject-&gt;id );\n        $this-&gt;get_discuss( $project_id, $newProject-&gt;id );\n        $this-&gt;get_task_list( $project_id, $newProject-&gt;id );\n\n        $this-&gt;get_file( $project_id, $newProject-&gt;id );\n\n\n        $this-&gt;get_activity( $project_id, $newProject-&gt;id, $this-&gt;discuss, $this-&gt;task_lists, $this-&gt;tasks, $this-&gt;comments );\n        $this-&gt;set_project_settings( $project_id, $newProject );\n        $this-&gt;set_bp_group( $project_id, $newProject );\n    \n        //Update migration project count number\n        $this-&gt;upgrade_observe_migration( [\n            &#39;projects&#39; =&gt; true\n        ] );\n\n        $this-&gt;pm_update_queue();\n\n        return $newProject;\n    }\n\n    public function pm_update_queue() {\n        //update background process data queue with pm_queue_data for individual project\n        $this-&gt;update(\n            $this-&gt;generate_key(),\n            $this-&gt;pm_queue_data\n        )-&gt;dispatch();\n\n        //After update background process queue make empty array for pm_queue_data\n        $this-&gt;pm_queue_data = [];\n    }\n\n    /**\n     * initialize upgrade\n     * Get all Project id and push into queue \n     * @return [type] [description]\n     */\n    public function upgrade_init ( ) {\n       \n        $this-&gt;start_update();\n        $this-&gt;set_count();\n        \n        $this-&gt;delete_queue_batch(); \n        \n        global $wpdb;\n        $ids = $wpdb-&gt;get_results( &quot;SELECT ID FROM $wpdb-&gt;posts WHERE post_type = &#39;cpm_project&#39;&quot;, ARRAY_A );\n\n        if ( is_wp_error( $ids ) ) {\n            return;\n        }\n\n        $ids = wp_list_pluck($ids, &#39;ID&#39;); \n        \n        foreach ($ids as $id) {\n            if ( empty( absint( $id ) ) ) {\n                continue;\n            }\n            $this-&gt;push_to_queue( [\n                &#39;type&#39; =&gt; &#39;project&#39;,\n                &#39;id&#39; =&gt; $id\n            ] );\n        }\n\n\n        $this-&gt;save()-&gt;dispatch();\n    }\n\n    /**\n     * Complete function for WP_Background_Process\n     *\n     */\n    // function complete() {\n    //     parent::complete();\n    //     $this-&gt;isProcessRuning = false;\n    //     $this-&gt;migrate_category();\n    //     $this-&gt;set_settings();\n        \n    //     // upgrade complete function\n    // }\n\n\n\n    /**\n     * Get batch\n     *\n     * @return stdClass Return the first batch from the queue\n     */\n    protected function delete_queue_batch() {\n        global $wpdb;\n\n        $table        = $wpdb-&gt;options;\n        $column       = &#39;option_name&#39;;\n        $key_column   = &#39;option_id&#39;;\n        $value_column = &#39;option_value&#39;;\n\n        if ( is_multisite() ) {\n            $table        = $wpdb-&gt;sitemeta;\n            $column       = &#39;meta_key&#39;;\n            $key_column   = &#39;meta_id&#39;;\n            $value_column = &#39;meta_value&#39;;\n        }\n\n        $key = $wpdb-&gt;esc_like( $this-&gt;identifier . &#39;_batch_&#39; ) . &#39;%&#39;;\n\n        $query = $wpdb-&gt;query( $wpdb-&gt;prepare( &quot;\n            DELETE \n            FROM {$table}\n            WHERE {$column} LIKE %s\n        &quot;, $key ) );\n    }\n\n    // public function admin_footer() {\n    //     add_action(&#39;admin_footer&#39;, array( $this, &#39;notification&#39; ) );\n    // }\n\n    public function notification() {\n        $this-&gt;set_count();\n\n        $is_run_update    = get_option( &#39;pm_start_migration&#39; );\n        $is_active_notice = get_option(&#39;pm_migration_notice&#39;);\n\n        if ( !empty( $is_active_notice ) || empty( $is_run_update ) ) {\n           return;\n        }\n        \n        echo &#39;&lt;div class=&quot;updated pm-update-progress-notice&quot;&gt;&lt;/div&gt;&#39;;\n        $db_observe = get_option( &#39;pm_observe_migration&#39; );\n\n        $observe = json_encode( $db_observe );\n        $assets_url = config(&#39;frontend.assets_url&#39;);\n\n        $result = array_diff( $db_observe[&#39;count&#39;], $db_observe[&#39;migrate&#39;] );\n        \n        $is_all_migrated = empty( $result ) ? true : false; \n        \n        ?&gt;\n            &lt;script type=&quot;text/javascript&quot;&gt;\n                var pm_is_all_migrated = &lt;?php echo json_encode($is_all_migrated); ?&gt;;\n\n                jQuery( document ).on( &#39;heartbeat-send&#39;, function ( event, data ) {\n                    data.pm_migration = true;\n                });\n\n                jQuery(document).ready(function() {\n                    var migrateData = &lt;?php echo $observe; ?&gt;;\n                    \n                    \n                    pmProgressStatus(migrateData, pm_is_all_migrated, function() {\n                        pmRemoveNotice();\n                    });\n                });\n\n                jQuery( document ).on( &#39;heartbeat-tick&#39;, function ( event, data ) {\n                    // Check for our data, and use it.\n                    if ( ! data.pm_migration ) {\n                        return;\n                    }\n\n                    pmProgressStatus(data.pm_migration, data.pm_is_all_migrated, function() {\n                        pmRemoveNotice();\n                    });\n\n                });\n\n                function pmProgressStatus(migrateData, pm_is_all_migrated, callBack ) {\n                    pm_is_all_migrated = pm_is_all_migrated || false;\n\n                    var migrations = {\n                        &#39;project&#39;: {\n                            label: &#39;Projects&#39;,\n                            status: pmGetStatus(migrateData.count.projects, migrateData.migrate.projects),\n                            count: migrateData.count.projects,\n                            completed: migrateData.migrate.projects,\n                        },\n                        &#39;task_list&#39;: {\n                            label: &#39;Task Lists&#39;,\n                            status: pmGetStatus(migrateData.count.lists, migrateData.migrate.lists),\n                            count: migrateData.count.lists,\n                            completed: migrateData.migrate.lists,\n                        },\n                        &#39;task&#39;: {\n                            label: &#39;Tasks&#39;,\n                            status: pmGetStatus(migrateData.count.tasks, migrateData.migrate.tasks),\n                            count: migrateData.count.tasks,\n                            completed: migrateData.migrate.tasks,\n                        },\n                        &#39;message&#39;: {\n                            label: &#39;Messages&#39;,\n                            status: pmGetStatus(migrateData.count.messages, migrateData.migrate.messages),\n                            count: migrateData.count.messages,\n                            completed: migrateData.migrate.messages,\n                        },\n                        &#39;milestone&#39;: {\n                            label: &#39;Milestones&#39;,\n                            status: pmGetStatus(migrateData.count.milestons, migrateData.migrate.milestons),\n                            count: migrateData.count.milestons,\n                            completed: migrateData.migrate.milestons,\n                        },\n                        &#39;comment&#39;: {\n                            label: &#39;Comments&#39;,\n                            status: pmGetStatus(migrateData.count.comments, migrateData.migrate.comments),\n                            count: migrateData.count.comments,\n                            completed: migrateData.migrate.comments,\n                        },\n\n                    };\n\n                    var tmplInside = &#39;&#39;;\n                    var cross = pm_is_all_migrated ? &#39;&lt;button type=&quot;button&quot; class=&quot;pm-notice-dismiss&quot;&gt;&lt;/button&gt;&#39; : &#39;&#39;;\n                    var is_loading_active = !pm_is_all_migrated ? &#39;pm-spinner&#39; : &#39;&#39;;\n                    \n                    jQuery.each(migrations, function(key, val) {\n                        var statuLogo = val.status ? &#39;pm-todo-migrate&#39; : &#39;pm-todo-refresh&#39;;\n                        \n                        tmplInside = tmplInside + &#39;&lt;div class=&quot;pm-single-migrate-wrap&quot;&gt;&lt;span class=&quot;&#39;+statuLogo+&#39;&quot;&gt;&lt;/sapn&gt;&#39;+val.label+&#39;: &#39;+val.completed+ &#39;/&#39; + val.count+ &#39;&lt;/div&gt;&#39;;\n                    });\n                    \n                    var tmpl = &#39;&lt;div&gt;&#39;+\n                        &#39;&lt;p&gt;&lt;strong&gt;Migration Status&lt;span class=&quot;&#39;+is_loading_active+&#39;&quot;&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&#39;+\n                        cross+\n                        tmplInside+&#39;&lt;/div&gt;&#39;;\n\n                    $(&#39;.pm-update-progress-notice&#39;).html(tmpl);\n\n                    if (typeof callBack !== &#39;undefined&#39;) {\n                        callBack();\n                    }\n                }\n\n                function pmGetStatus(count, migrate) {\n                    count = parseInt(count);\n                    migrate = parseInt(migrate);\n\n                    return count &lt;= migrate ? true : false;\n                }\n\n                function pmRemoveNotice () {\n                    $(&#39;.pm-notice-dismiss&#39;).click(function() {\n                        $(&#39;.pm-update-progress-notice&#39;).slideUp( 300, function() {\n                            \n                            $(&#39;.pm-update-progress-notice&#39;).remove();\n                        });\n                    \n                        $.ajax({\n                            type: &#39;POST&#39;,\n                            url: PM_Vars.base_url +&#39;/&#39;+ PM_Vars.rest_api_prefix +&#39;/pm/v2/settings/notice&#39;,\n                            data: {\n                                action: &#39;pm_migration_notice&#39;,\n                            }\n                        });\n                    });\n                }\n            \n\n            &lt;/script&gt;\n            &lt;style&gt;\n                .updated {\n                    position: relative;\n                } \n                .pm-notice-dismiss {\n                    position: absolute;\n                    top: 11px;\n                    right: 1px;\n                    border: none;\n                    margin: 0;\n                    padding: 9px;\n                    background: none;\n                    color: #72777c;\n                    cursor: pointer;\n                }\n                .pm-notice-dismiss:before {\n                    background: none;\n                    color: #72777c;\n                    content: &quot;\\f153&quot;;\n                    display: block;\n                    font: normal 16px/20px dashicons;\n                    speak: none;\n                    height: 20px;\n                    text-align: center;\n                    width: 20px;\n                    -webkit-font-smoothing: antialiased;\n                }\n                .pm-single-migrate-wrap {\n                    margin-bottom: 5px;\n                    display: inline-block;\n                    margin-right: 3%;\n                    padding-top: 4px;\n                    /*border-right: 1px solid #d2d2d2;*/\n                }\n                .pm-single-migrate-wrap:last-child {\n                    border-right: none;\n                }\n\n                .ui-progressbar {\n                    position: relative;\n                }\n                .hrm-progress-label {\n                    position: absolute;\n                    left: 50%;\n                    top: 4px;\n                    font-weight: bold;\n                    text-shadow: 1px 1px 0 #fff;\n                }\n\n                .pm-todo-refresh {\n                    background-image: url(&#39;&lt;?php echo $assets_url; ?&gt;images/refresh.svg&#39;);\n                    padding-left: 28px;\n                    background-size: 20px;\n                    background-repeat: no-repeat;\n                    padding-bottom: 4px;\n                }\n                .pm-todo-migrate {\n                    background-image: url(&#39;&lt;?php echo $assets_url; ?&gt;images/todo_completed.svg&#39;);\n                    padding-left: 28px;\n                    background-size: 17px;\n                    background-repeat: no-repeat;\n                    padding-bottom: 4px;\n                }\n                .pm-spinner {\n                  background: url(&quot;&lt;?php echo $assets_url; ?&gt;images/loading.gif&quot;) no-repeat scroll 0 0 rgba(0, 0, 0, 0);\n                  height: 16px;\n                  display: inline-block;\n                  width: 16px;\n                  margin-left: 10px;\n                }\n            &lt;/style&gt;\n        &lt;?php\n    }\n\n    function start_update() {\n        update_option( &#39;pm_start_migration&#39;, true );\n    }\n\n    function upgrade_observe_migration( $args ) {\n        $migration = get_option( &#39;pm_observe_migration&#39; );\n\n        if ( !empty( $args[&#39;projects&#39;] ) ) {\n            $migration[&#39;migrate&#39;][&#39;projects&#39;] =  $migration[&#39;migrate&#39;][&#39;projects&#39;] + 1;\n        }\n\n        if ( !empty( $args[&#39;lists&#39;] ) ) {\n            $migration[&#39;migrate&#39;][&#39;lists&#39;] =  $migration[&#39;migrate&#39;][&#39;lists&#39;] + 1;\n        }\n\n        if ( !empty( $args[&#39;tasks&#39;] ) ) {\n            $migration[&#39;migrate&#39;][&#39;tasks&#39;] =  $migration[&#39;migrate&#39;][&#39;tasks&#39;] + 1;\n        }\n\n        if ( !empty( $args[&#39;messages&#39;] ) ) {\n            $migration[&#39;migrate&#39;][&#39;messages&#39;] =  $migration[&#39;migrate&#39;][&#39;messages&#39;] + 1;\n        }\n\n        if ( !empty( $args[&#39;milestons&#39;] ) ) {\n            $migration[&#39;migrate&#39;][&#39;milestons&#39;] =  $migration[&#39;migrate&#39;][&#39;milestons&#39;] + 1;\n        }\n\n        if ( !empty( $args[&#39;comments&#39;] ) ) {\n            $migration[&#39;migrate&#39;][&#39;comments&#39;] =  $migration[&#39;migrate&#39;][&#39;comments&#39;] + 1;\n        }\n\n        update_option( &#39;pm_observe_migration&#39;, $migration );\n    }\n\n    public function set_count() {\n        global $wpdb;\n\n        $has_migration = get_option( &#39;pm_observe_migration&#39; );\n\n        if ( ! empty( $has_migration ) ) {\n            return;\n        }\n\n        $ids = $wpdb-&gt;get_results( &quot;SELECT ID FROM $wpdb-&gt;posts WHERE post_type = &#39;cpm_project&#39;&quot;, ARRAY_A );\n        $ids = wp_list_pluck($ids, &#39;ID&#39;); \n        \n        $lists = [];\n        $tasks = [];\n        $messages = [];\n        $milestons = [];\n\n        foreach ( $ids as $key =&gt; $project_id ) {\n            $list_ids = $wpdb-&gt;get_results( \n                &quot;\n                SELECT ID FROM $wpdb-&gt;posts \n                WHERE\n                post_parent = $project_id\n                AND\n                post_type = &#39;cpm_task_list&#39;\n                AND\n                post_status = &#39;publish&#39;\n                &quot;\n            );\n\n            $list_ids = wp_list_pluck( $list_ids, &#39;ID&#39; );\n            $lists    = array_merge( $list_ids, $lists );\n            $string_list_id = implode( &#39;,&#39;, $list_ids );\n            $string_list_id = empty( $string_list_id ) ? &#39;0&#39; : $string_list_id;\n\n            $task_ids = $wpdb-&gt;get_results( \n                &quot;\n                SELECT ID FROM $wpdb-&gt;posts \n                WHERE\n                post_parent IN ( $string_list_id )\n                AND\n                post_type = &#39;cpm_task&#39;\n                AND\n                post_status = &#39;publish&#39;\n                &quot;\n            );\n\n            $task_ids = wp_list_pluck( $task_ids, &#39;ID&#39; );\n            $tasks    = array_merge( $task_ids, $tasks );\n\n            $mileston_ids = $wpdb-&gt;get_results( \n                &quot;\n                SELECT ID FROM $wpdb-&gt;posts \n                WHERE\n                post_parent = $project_id\n                AND\n                post_type IN (&#39;cpm_milestone&#39;, &#39;cpm_milestne&#39;)\n                AND\n                post_status = &#39;publish&#39;\n                &quot;\n            );\n\n            $mileston_ids = wp_list_pluck( $mileston_ids, &#39;ID&#39; );\n            $milestons    = array_merge( $mileston_ids, $milestons );\n\n            $message_ids = $wpdb-&gt;get_results( \n                &quot;\n                SELECT ID FROM $wpdb-&gt;posts \n                WHERE\n                post_parent = $project_id\n                AND\n                post_type = &#39;cpm_message&#39;\n                AND\n                post_status = &#39;publish&#39;\n                &quot;\n            );\n\n            $message_ids = wp_list_pluck( $message_ids, &#39;ID&#39; );\n            $messages    = array_merge( $message_ids, $messages );\n        }\n\n        $all_post_ids = array_merge( $lists, $tasks, $messages, $milestons );\n        $all_post_ids = implode(&#39;,&#39;, $all_post_ids);\n\n        $count_comments   = $wpdb-&gt;get_var( \n            &quot;\n            SELECT count(comment_ID) FROM $wpdb-&gt;comments\n            WHERE comment_post_ID IN ($all_post_ids)\n            &quot;\n        );\n\n        $observe = [\n            &#39;count&#39; =&gt; [\n                &#39;projects&#39;  =&gt; count( $ids ),\n                &#39;lists&#39;     =&gt; count( $lists ),\n                &#39;tasks&#39;     =&gt; count( $tasks ),\n                &#39;messages&#39;  =&gt; count( $messages ),\n                &#39;milestons&#39; =&gt; count( $milestons ),\n                &#39;comments&#39;  =&gt; $count_comments\n            ],\n\n            &#39;migrate&#39; =&gt; [\n                &#39;projects&#39;  =&gt; 0,\n                &#39;lists&#39;     =&gt; 0,\n                &#39;tasks&#39;     =&gt; 0,\n                &#39;messages&#39;  =&gt; 0,\n                &#39;milestons&#39; =&gt; 0,\n                &#39;comments&#39;  =&gt; 0\n            ]\n        ];\n\n        update_option( &#39;pm_observe_migration&#39;, $observe );\n\n        return $observe;\n    }\n\n    /**\n     * start upgrade project \n     * @param  ini $project_id \n     * @return Object          new project model object \n     */\n    public function upgrade_projects( $project_id ) {\n        $project_ids = get_site_option( &quot;pm_db_migration&quot;, [] );\n        \n        if ( array_key_exists( $project_id, $project_ids ) ) {\n            return false;\n        }\n\n        $project_ids[$project_id] = 0;\n        update_site_option(&quot;pm_db_migration&quot;, $project_ids);\n\n        $project = $this-&gt;create_project( $project_id ); \n        \n        if ( $project ) {\n            $project_ids[$project_id] = $project-&gt;id;\n            update_site_option( &quot;pm_db_migration&quot;, $project_ids );\n        }\n    }\n\n\n\n    /**\n     * create project role \n     * @param  init $oldProjectId\n     * @param  init $newProjectID       \n     * @param  init $assigned_by \n     * @return void              \n     */\n    function create_project_role( $oldProjectId, $newProjectID, $assigned_by ){\n        if( !$oldProjectId ){\n            return ;\n        }\n        global $wpdb;\n        $table    = $wpdb-&gt;prefix . &#39;cpm_user_role&#39;;\n        $oldroles = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT * FROM $table WHERE project_id=%d&quot;, $oldProjectId ), ARRAY_A );\n        if ( is_wp_error( $oldroles ) ) {\n            return;\n        }\n        foreach ($oldroles as $role ) {\n            if ( $role[&#39;role&#39;]       == &#39;manager&#39; ){\n                $role_id = 1;\n            }else if ( $role[&#39;role&#39;] == &#39;co_worker&#39; ){\n                $role_id = 2;\n            }else{\n                $role_id = 3; \n            }\n            $this-&gt;save_object( new User_Role, [\n                &#39;user_id&#39;       =&gt; $role[&#39;user_id&#39;],\n                &#39;role_id&#39;       =&gt; $role_id,\n                &#39;project_id&#39;    =&gt; $newProjectID,\n                &#39;assigned_by&#39;   =&gt; $assigned_by,\n            ] );\n        }\n    }\n\n\n    function get_milestones( $oldProjectId, $newProjectID  ) {\n        if( !$oldProjectId ){\n            return ;\n        }\n        global $wpdb;\n\n        $oldMilestones   = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT * FROM $wpdb-&gt;posts WHERE post_parent=%d AND post_type in (&#39;cpm_milestne&#39;, &#39;cpm_milestone&#39;) AND post_status=%s&quot;, $oldProjectId, &#39;publish&#39; ), ARRAY_A );\n        $milestons  = [];\n        \n        foreach ( $oldMilestones as $post ) {\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;         =&gt; &#39;milestone&#39;,\n                &#39;id&#39;           =&gt; $post[&#39;ID&#39;],\n                &#39;oldProjectId&#39; =&gt; $oldProjectId,\n                &#39;newProjectID&#39; =&gt; $newProjectID,\n                &#39;post&#39;         =&gt; $post\n            ];\n        }\n\n        //$this-&gt;save()-&gt;dispatch();\n    }\n\n    /**\n     * create milestone \n     * @param  init $project_id \n     * @param  object $newProject new project Model\n     * @return arrat             old milestone and new milestone \n     */\n    function create_milestone( $milestone, $newProjectID ) {\n        if( !$milestone ){\n            return ;\n        }\n\n        $newMilestone = $this-&gt;add_board( $milestone, &#39;milestone&#39;,  $newProjectID );\n        $completed_at = get_post_meta( $milestone[&#39;ID&#39;], &#39;_completed_on&#39;, true );\n        $meta = [\n            &#39;achieve_date&#39; =&gt; get_post_meta( $milestone[&#39;ID&#39;], &#39;_due&#39;, true ),\n            &#39;status&#39;       =&gt; get_post_meta( $milestone[&#39;ID&#39;], &#39;_completed&#39; , true ) == 1 ? 2 : 1,\n        ];\n        if( !empty( $completed_at ) ) {\n            $meta[&#39;completed_at&#39;] = $completed_at;\n        }\n\n        $mil_pri = get_post_meta( $milestone[&#39;ID&#39;], &#39;_milestone_privac&#39;, true );\n        if( isset( $mil_pri ) &amp;&amp; $mil_pri == &#39;yes&#39; ){\n            $meta[&#39;privacy&#39;] = 1;\n        }\n\n\n        if ( $newMilestone-&gt;id &amp;&amp; isset( $meta ) ) {\n            $this-&gt;add_meta( $meta, $newMilestone, $newProjectID );\n        }\n\n        $this-&gt;upgrade_observe_migration( [\n            &#39;milestons&#39; =&gt; true\n        ] );\n        \n        return $newMilestone-&gt;id;\n    }\n    /**\n     * get Dsicuss and create from\n     * @param  int $oldProjectId \n     * @param  int $newProjectID \n     * @param  array $milestons    \n     * @return array               new and old milestone array\n     */\n    function get_discuss( $oldProjectId, $newProjectID ) {\n        if( !$oldProjectId ){\n            return ;\n        }\n        global $wpdb;\n\n        $oldDiscuss = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT * FROM $wpdb-&gt;posts WHERE post_parent=%d AND post_type=%s AND post_status=%s&quot;, $oldProjectId, &#39;cpm_message&#39;, &#39;publish&#39; ), ARRAY_A );\n        $discuss  = [];\n\n        foreach ( $oldDiscuss as $post ) {\n            $this-&gt;pm_queue_data[] =[\n                &#39;type&#39;         =&gt; &#39;discuss&#39;,\n                &#39;id&#39;           =&gt; $post[&#39;ID&#39;],\n                &#39;old_project&#39;  =&gt; $oldProjectId,\n                &#39;newProjectID&#39; =&gt; $newProjectID,\n                &#39;post&#39;         =&gt; $post\n            ];\n        }\n    }\n\n    /**\n     * Create disusss from old discuss\n     */\n    function create_discuss( $post, $newProjectID ) {\n        if( !$post ) {\n            return ;\n        }\n        $newDiscuss = $this-&gt;add_board( $post, &#39;discussion_board&#39;, $newProjectID );\n        $mid        = get_post_meta( $post[&#39;ID&#39;], &#39;_milestone&#39;, true );\n\n        if ( $mid &amp;&amp; !empty( $this-&gt;milestons ) ) {\n            $this-&gt;save_object( new Boardable, [\n                &#39;board_id&#39;       =&gt; $this-&gt;milestons[$mid],\n                &#39;board_type&#39;     =&gt; &#39;milestone&#39;,\n                &#39;boardable_id&#39;   =&gt; $newDiscuss-&gt;id,\n                &#39;boardable_type&#39; =&gt; &#39;discussion_board&#39;,\n                &#39;order&#39;          =&gt; $post[&#39;menu_order&#39;],\n                &#39;created_by&#39;     =&gt; $post[&#39;post_author&#39;],\n                &#39;updated_by&#39;     =&gt; $post[&#39;post_author&#39;],\n                &#39;created_at&#39;     =&gt; $post[&#39;post_date&#39;],\n                &#39;updated_at&#39;     =&gt; $post[&#39;post_modified&#39;],\n            ] );\n        }\n\n        $mag_pri = get_post_meta( $post[&#39;ID&#39;], &#39;_message_privacy&#39;, true );\n        if( isset( $mag_pri ) &amp;&amp; $mag_pri == &#39;yes&#39; ){\n            $meta[&#39;privacy&#39;] = 1;\n        }\n\n        if ( isset( $meta ) &amp;&amp; !empty( $meta )) {\n            $this-&gt;add_meta( $meta,  $newDiscuss, $newProjectID );\n        }\n\n        $files = get_post_meta( $post[&#39;ID&#39;], &#39;_files&#39;, true);\n        if ( !empty( $files )) {\n            foreach ( $files as $file ) {\n                \n                $this-&gt;add_file( [\n                    &#39;fileable_id&#39;   =&gt; $newDiscuss-&gt;id,\n                    &#39;fileable_type&#39; =&gt; &#39;discussion_board&#39;,\n                    &#39;parent&#39;        =&gt; 0,\n                    &#39;type&#39;          =&gt; &#39;file&#39;,\n                    &#39;attachment_id&#39; =&gt; $file,\n                    &#39;project_id&#39;    =&gt; $newDiscuss-&gt;project_id,\n                    &#39;created_by&#39;    =&gt; $newDiscuss-&gt;created_by,\n                    &#39;updated_by&#39;    =&gt; $newDiscuss-&gt;updated_by,\n                ] );\n            }\n        }\n\n        $this-&gt;upgrade_observe_migration( [\n            &#39;messages&#39; =&gt; true\n        ] );\n        \n        return $newDiscuss-&gt;id;\n    }\n\n    /**\n     * get Task list and create from\n     * @param  int $oldProjectId \n     * @param  int $newProjectID \n     * @param  array $milestons    \n     * @return array               new and old milestone array\n     */\n    function get_task_list( $oldProjectId, $newProjectID ) {\n        if( !$oldProjectId ){\n            return ;\n        }\n        global $wpdb;\n\n        $oldTaskList   = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT * FROM $wpdb-&gt;posts WHERE post_parent=%d AND post_type=%s AND post_status=%s&quot;, $oldProjectId, &#39;cpm_task_list&#39;, &#39;publish&#39; ), ARRAY_A );\n\n        $taskList  = [];\n\n        foreach ( $oldTaskList as $post ) {\n\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;          =&gt; &#39;task_list&#39;,\n                &#39;id&#39;            =&gt; $post[&#39;ID&#39;],\n                &#39;newProjectID&#39;  =&gt; $newProjectID,\n                &#39;oldProjectId&#39; =&gt; $oldProjectId,\n                &#39;post&#39;          =&gt; $post\n            ];\n        }\n    }\n\n\n    /**\n     * Create disusss from old discuss\n     */\n    function create_task_list( $post, $newProjectID ) {\n        if( !$post ) {\n            return ;\n        }\n        $taskList = $this-&gt;add_board( $post, &#39;task_list&#39;, $newProjectID );\n        $mid      = get_post_meta( $post[&#39;ID&#39;], &#39;_milestone&#39;, true );\n        $mid      = intval( $mid );\n        if ( !empty( $mid ) &amp;&amp; $mid != -1 &amp;&amp; !empty( $this-&gt;milestons ) ) {\n            $this-&gt;save_object( new Boardable, [\n                &#39;board_id&#39;       =&gt; $this-&gt;milestons[$mid],\n                &#39;board_type&#39;     =&gt; &#39;milestone&#39;,\n                &#39;boardable_id&#39;   =&gt; $taskList-&gt;id,\n                &#39;boardable_type&#39; =&gt; &#39;task_list&#39;,\n                &#39;order&#39;          =&gt; $post[&#39;menu_order&#39;],\n                &#39;created_by&#39;     =&gt; $post[&#39;post_author&#39;],\n                &#39;updated_by&#39;     =&gt; $post[&#39;post_author&#39;],\n                &#39;created_at&#39;     =&gt; $post[&#39;post_date&#39;],\n                &#39;updated_at&#39;     =&gt; $post[&#39;post_modified&#39;],\n            ] );\n        }\n        $meta = array();\n        $list_pri = get_post_meta( $post[&#39;ID&#39;], &#39;_tasklist_privacy&#39;, true );\n        if( isset( $list_pri ) &amp;&amp; $list_pri == &#39;on&#39; ){\n            $meta[&#39;privacy&#39;] = 1;\n        }\n        \n        if ( !empty( $meta ) ) {\n            $this-&gt;add_meta( $meta,  $taskList, $newProjectID );\n        }\n\n        $this-&gt;upgrade_observe_migration( [\n            &#39;lists&#39; =&gt; true\n        ] );\n\n        return  $taskList-&gt;id;\n    }\n\n    function get_tasks( $oldProjectID, $newProjectID, $listitems, $list = null, $parent = null ) {\n\n        if( empty( $listitems ) ) {\n            return ;\n        }\n        global $wpdb;\n        if( $parent == null ){\n            $post_type = &#39;cpm_task&#39;;\n        }else{\n            $post_type = &#39;cpm_sub_task&#39;;\n        }\n        \n        $in         = implode( &#39;,&#39;, array_keys( $listitems  ));\n        $oldTask    = $wpdb-&gt;get_results( &quot;SELECT * FROM {$wpdb-&gt;posts} WHERE post_parent IN ({$in}) AND  post_type=&#39;{$post_type}&#39; AND post_status=&#39;publish&#39;&quot;, ARRAY_A );\n        $tasks      = [];\n        $taskParent = [];\n\n        foreach ( $oldTask as $post ) {\n\n            if( $post[&#39;post_type&#39;] == &#39;cpm_task&#39; ){\n                $this-&gt;taskParent[$post[&#39;ID&#39;]] = $post[&#39;post_parent&#39;];\n            }\n\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;         =&gt; &#39;task&#39;,\n                &#39;id&#39;           =&gt; $post[&#39;ID&#39;],\n                &#39;listitems&#39;    =&gt; $listitems,\n                &#39;newProjectID&#39; =&gt; $newProjectID,\n                &#39;old_project_id&#39; =&gt; $oldProjectID,\n                &#39;list&#39;         =&gt; $list,\n                &#39;post&#39;         =&gt; $post,\n                &#39;parent&#39;       =&gt; $parent,\n            ];\n        }\n\n        //$this-&gt;save()-&gt;dispatch();\n        //return array( $tasks, $taskParent );\n    }\n\n    function create_task( $post, $newProjectID,  $listitems, $list=null, $parent = null, $old_project_id = 0 ) {\n        if( !$post ){\n            return ;\n        }\n        $newTask  = $this-&gt;save_object( new Task, [\n            &#39;title&#39;       =&gt; $post[&#39;post_title&#39;],\n            &#39;description&#39; =&gt; $post[&#39;post_content&#39;],\n            &#39;status&#39;      =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;_completed&#39;, true),\n            &#39;project_id&#39;  =&gt; $newProjectID, \n            &#39;start_at&#39;    =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;_start&#39;, true),\n            &#39;due_date&#39;    =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;_due&#39;, true),\n            &#39;parent_id&#39;   =&gt; $post[&#39;post_type&#39;] === &#39;cpm_task&#39; ? 0: $listitems[$post[&#39;post_parent&#39;]],\n            &#39;created_by&#39;  =&gt; $post[&#39;post_author&#39;],\n            &#39;updated_by&#39;  =&gt; $post[&#39;post_author&#39;],\n            &#39;created_at&#39;  =&gt; $post[&#39;post_date&#39;],\n            &#39;updated_at&#39;  =&gt; $post[&#39;post_modified&#39;],\n        ] );\n\n        if( !empty( $post[&#39;post_parent&#39;] ) ) {\n\n            if( $parent !== null ) {\n                $board_id = $list[$parent[$post[&#39;post_parent&#39;]]];\n                $boardable_type = &#39;sub_task&#39;;\n            }else {\n                $board_id = $listitems[$post[&#39;post_parent&#39;]];\n                $boardable_type = &#39;task&#39;;\n            }\n            $this-&gt;save_object( new Boardable, [\n                &#39;board_id&#39;       =&gt; $board_id,\n                &#39;board_type&#39;     =&gt; &#39;task_list&#39;,\n                &#39;boardable_id&#39;   =&gt; $newTask-&gt;id,\n                &#39;boardable_type&#39; =&gt; $boardable_type,\n                &#39;order&#39;          =&gt; $post[&#39;menu_order&#39;],\n                &#39;created_by&#39;     =&gt; $post[&#39;post_author&#39;],\n                &#39;updated_by&#39;     =&gt; $post[&#39;post_author&#39;],\n                &#39;created_at&#39;     =&gt; $post[&#39;post_date&#39;],\n                &#39;updated_at&#39;     =&gt; $post[&#39;post_modified&#39;],\n            ] );\n        }\n\n        if ( $post[&#39;post_type&#39;] == &#39;cpm_task&#39; ){\n            $meta     = array();\n            $task_pri = get_post_meta( $post[&#39;ID&#39;], &#39;_task_privacy&#39;, true );\n            if ( !empty( $task_pri ) &amp;&amp; $task_pri == &#39;yes&#39; ){\n                $meta[&#39;privacy&#39;] = 1;\n            }\n\n            if ( $newTask-&gt;id &amp;&amp; !empty( $meta ) ) {\n                $this-&gt;add_meta( $meta,  $newTask, $newProjectID, $boardable_type );\n            }\n        }\n\n        $this-&gt;add_assignee( $newTask, $post[&#39;ID&#39;] );\n\n        $task_migrate_record = get_site_option( &#39;pm_task_migration&#39; );\n\n        $task_migrate_record[] =  [\n            &#39;old_project_id&#39; =&gt; $old_project_id,\n            &#39;new_project_id&#39; =&gt; $newProjectID,\n            &#39;old_task_id&#39;    =&gt; $post[&#39;ID&#39;],\n            &#39;new_task_id&#39;    =&gt; $newTask-&gt;id\n        ];\n        \n\n        update_site_option( &#39;pm_task_migration&#39;, $task_migrate_record );\n\n        $this-&gt;upgrade_observe_migration( [\n            &#39;tasks&#39; =&gt; true\n        ] );\n\n        return $newTask-&gt;id;\n    }\n\n    function add_assignee( $task, $post_id ) {\n        if ( !$post_id ){\n            return ;\n        }\n        $assignees = get_post_meta( $post_id, &#39;_assigned&#39; );\n\n        if ( empty( $assignees ) || array_keys( $assignees, &#39;-1&#39; )) {\n            return ;\n        }\n\n        foreach ( $assignees as $assignee ) {\n\n            $completd_by = get_post_meta( $post_id, &#39;_completed_by&#39;, true );\n            $completed_at = null;\n            if ( !empty( $completd_by )  &amp;&amp; $assignee == $completd_by ) {\n                $completed_at = get_post_meta( $post_id, &#39;_completed_on&#39;, true);\n                $completed_at = !empty( $completed_at ) ? $completed_at: null;\n            }\n            $this-&gt;save_object( new Assignee, [\n                &#39;task_id&#39;      =&gt; $task-&gt;id,\n                &#39;assigned_to&#39;  =&gt; (int)$assignee,\n                &#39;assigned_at&#39;  =&gt; $task-&gt;created_at,\n                &#39;completed_at&#39; =&gt; $completed_at,\n                &#39;created_by&#39;   =&gt; $task-&gt;created_by,\n                &#39;updated_by&#39;   =&gt; $task-&gt;updated_by,\n                &#39;created_at&#39;   =&gt; $task-&gt;created_at,\n                &#39;updated_at&#39;   =&gt; $task-&gt;updated_at,\n                &#39;project_id&#39;   =&gt; $task-&gt;project_id,\n            ] );\n        }\n    }\n\n    function get_comments( $ids, $newProjectID, $commentable_type ) {\n\n        if( empty( $ids ) ){\n            return ;\n        }\n        global $wpdb;\n        $in        = implode(&#39;,&#39;, array_keys( $ids ) );\n        $comments = $wpdb-&gt;get_results( &quot;SELECT * FROM {$wpdb-&gt;comments} WHERE comment_post_ID IN({$in})&quot;, ARRAY_A );\n       \n        foreach ( $comments as $comment ) {\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;             =&gt; &#39;comment&#39;,\n                &#39;id&#39;               =&gt; $comment[&#39;comment_ID&#39;],\n                &#39;comment&#39;          =&gt; $comment,\n                &#39;newProjectID&#39;     =&gt; $newProjectID,\n                &#39;commentable_type&#39; =&gt; $commentable_type,\n                &#39;id&#39;               =&gt; $ids[$comment[&#39;comment_post_ID&#39;]]\n            ];\n        }\n    }\n\n    function create_comments( $comment, $newProjectID, $commentable_type, $commentable_id ) {\n        if( !$comment ){\n            return ;\n        }\n        $newComment = $this-&gt;save_object( new Comment, [\n            &#39;content&#39;          =&gt; $comment[&#39;comment_content&#39;],\n            &#39;mentioned_users&#39;  =&gt; null,\n            &#39;commentable_id&#39;   =&gt; $commentable_id,\n            &#39;commentable_type&#39; =&gt; $commentable_type,\n            &#39;project_id&#39;       =&gt; $newProjectID,\n            &#39;created_by&#39;       =&gt; $comment[&#39;user_id&#39;],\n            &#39;updated_by&#39;       =&gt; $comment[&#39;user_id&#39;],\n            &#39;updated_by&#39;       =&gt; $comment[&#39;user_id&#39;],\n            &#39;updated_by&#39;       =&gt; $comment[&#39;user_id&#39;],\n            &#39;created_at&#39;       =&gt; $comment[&#39;comment_date&#39;],\n            &#39;updated_at&#39;       =&gt; $comment[&#39;comment_date&#39;],\n        ] );\n\n        $files = get_comment_meta( $comment[&#39;comment_ID&#39;], &#39;_files&#39;, true );\n        if ( !empty( $files ) ) {\n            foreach ( $files as $file ) {\n                \n                $this-&gt;add_file( [\n                    &#39;fileable_id&#39;   =&gt; $newComment-&gt;id,\n                    &#39;fileable_type&#39; =&gt; &#39;comment&#39;,\n                    &#39;parent&#39;        =&gt; 0,\n                    &#39;type&#39;          =&gt; &#39;file&#39;,\n                    &#39;attachment_id&#39; =&gt; $file,\n                    &#39;project_id&#39;    =&gt; $newComment-&gt;project_id,\n                    &#39;created_by&#39;    =&gt; $newComment-&gt;created_by,\n                    &#39;updated_by&#39;    =&gt; $newComment-&gt;updated_by,\n                ] );\n            }\n        }\n\n        $this-&gt;upgrade_observe_migration( [\n            &#39;comments&#39; =&gt; true\n        ] );\n\n        return $newComment-&gt;id;\n    }\n\n    function get_invoice( $oldProjectId, $newProject ) {\n        $invoice = false;\n\n        if ( \n            function_exists( &#39;pm_pro_is_module_inactive&#39; ) \n                &amp;&amp; \n            pm_pro_is_module_inactive( &#39;invoice/invoice.php&#39; ) \n        ) {\n            pm_pro_activate_module( &#39;invoice/invoice.php&#39; );\n            $invoice = true;\n        }\n\n        global $wpdb;\n\n        $oldInvoice   = $wpdb-&gt;get_results( $wpdb-&gt;prepare( &quot;SELECT * FROM $wpdb-&gt;posts WHERE post_parent=%d AND post_type=%s&quot;, $oldProjectId, &#39;cpm_invoice&#39; ), ARRAY_A );\n        \n        $invoice  = [];\n\n        foreach ( $oldInvoice as $post ) {\n            $invoice[$post[&#39;ID&#39;]] = $this-&gt;create_invoice( $post, $newProject );\n        }\n        \n        if ( $invoice ) {\n            pm_pro_deactivate_module( &#39;invoice/invoice.php&#39; );\n        }\n\n    }\n\n    function create_invoice( $post, $newProject ) {\n        $invoiceArr =[\n            &#39;client_id&#39;      =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;client_id&#39;, true ),\n            &#39;title&#39;          =&gt; $post[&#39;post_title&#39;] ,\n            &#39;start_at&#39;       =&gt; $post[&#39;post_date&#39;],\n            &#39;due_date&#39;       =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;due_date&#39;, true ),\n            &#39;discount&#39;       =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;discount&#39;, true ),\n            &#39;partial&#39;        =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;partial_payment&#39;, true ) == &#39;yes&#39; ? 1 : 0,\n            &#39;partial_amount&#39; =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;partial_amount&#39;, true ),\n            &#39;terms&#39;          =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;terms&#39;, true ),\n            &#39;client_note&#39;    =&gt; $post[&#39;post_content&#39;],\n            &#39;items&#39;          =&gt; serialize( $this-&gt;get_invoice_item( $post, $newProject ) ),\n            &#39;project_id&#39;     =&gt; $newProject,\n            &#39;status&#39;         =&gt; get_post_meta( $post[&#39;ID&#39;], &#39;statue&#39;, true ) == &#39;paid&#39; ? 1 : 0,\n            &#39;created_by&#39;     =&gt; $post[&#39;post_author&#39;],\n            &#39;updated_by&#39;     =&gt; $post[&#39;post_author&#39;],\n            &#39;created_at&#39;     =&gt; $post[&#39;post_date&#39;],\n            &#39;updated_at&#39;     =&gt; $post[&#39;post_modified&#39;],\n        ];\n\n        $invoice = $this-&gt;save_object(new Invoice, $invoiceArr );\n\n        $payments = get_post_meta( $post[&#39;ID&#39;], &#39;cpmi_payment&#39;, true );\n\n        if( !empty($payments) ) {\n            foreach ( $payments as $payment ) {\n                $payment_date = empty( $payment[&#39;date&#39;] ) ? $post[&#39;post_modified&#39;] : $payment[&#39;date&#39;];\n\n                $data = [\n                    &#39;entity_id&#39;   =&gt; $invoice-&gt;id,\n                    &#39;entity_type&#39; =&gt; &#39;invoice&#39;,\n                    &#39;meta_key&#39;    =&gt; &#39;invoice_payment&#39;,\n                    &#39;meta_value&#39;  =&gt; maybe_serialize([\n                        &#39;amount&#39;  =&gt; floatval( $payment[&#39;amount&#39;] ),\n                        &#39;date&#39;    =&gt; date( &#39;Y-m-d&#39;, strtotime( $payment_date ) ),\n                        &#39;notes&#39;   =&gt; $payment[&#39;notes&#39;],\n                        &#39;gateway&#39; =&gt; $payment[&#39;method&#39;]\n                    ]),\n                    &#39;project_id&#39; =&gt; $newProject,\n                    &#39;created_by&#39;  =&gt; $invoice-&gt;client_id,\n                    &#39;updated_by&#39;  =&gt; $invoice-&gt;client_id,\n                    &#39;created_at&#39;  =&gt; $payment_date,\n                    &#39;updated_at&#39;  =&gt; $payment_date,\n                ];\n                $this-&gt;save_object( New Meta, $data );\n                \n            }\n        }\n\n        \n\n        return $invoice-&gt;id;\n    }\n\n    function get_invoice_item( $post, $newProject ) {\n        $items = get_post_meta( $post[&#39;ID&#39;], &#39;item&#39;, true );\n        $hours = get_post_meta( $post[&#39;ID&#39;], &#39;hour&#39;, true );\n        $newItem = array();\n\n        foreach ( $items as $item ) {\n            $arr = [];\n            $arr[&#39;task&#39;] = $this-&gt;get_task_by_title( $item-&gt;name, $newProject ); // find id, title time\n            $arr[&#39;description&#39;]  = $item-&gt;details;\n            $arr[&#39;amount&#39;]  = $item-&gt;amount;\n            $arr[&#39;quantity&#39;]  = $item-&gt;qty;\n            $arr[&#39;tax&#39;]  = $item-&gt;tax_percent;\n            $arr[&#39;descriptionField&#39;]  = isset($item-&gt;details);\n\n            $newItem[&#39;entryNames&#39;][] = $arr;\n        }\n\n        foreach ( $hours as $item ) {\n            $arr = [];\n            $arr[&#39;task&#39;] = $this-&gt;get_task_by_title( $item-&gt;name, $newProject  ); // find id, title time\n            $arr[&#39;description&#39;]  = $item-&gt;details;\n            $arr[&#39;amount&#39;]  = $item-&gt;amount;\n            $arr[&#39;hour&#39;]  = $item-&gt;qty;\n            $arr[&#39;tax&#39;]  = $item-&gt;tax_percent;\n            $arr[&#39;descriptionField&#39;]  = isset($item-&gt;details);\n\n            $newItem[&#39;entryTasks&#39;][] = $arr;\n        }\n       return $newItem; \n    }\n\n    function get_task_by_title( $title , $newProject  ) {\n        if( empty( $title ) ) {\n            return [];\n        }\n\n        $task = Task::where(&#39;title&#39;, $title )-&gt;where( &#39;project_id&#39;, $newProject )-&gt;first();\n\n        if( ! $task-&gt;id ) {\n            return [];\n        }\n\n        $arr[&#39;id&#39;] = $task-&gt;id;\n        $arr[&#39;title&#39;] = $task-&gt;title;\n        $arr[&#39;time&#39;] = [\n            &#39;hour&#39; =&gt; 0\n        ];\n\n        return $arr;\n    }\n\n    function set_project_settings( $oldProjectId, $newProject ) {\n\n        $settings = get_post_meta( 27, &#39;_settings&#39;, true);\n        if ( empty( $sections ) ) {\n            return ;\n        }\n\n        $co_worker = array();\n        $client    = array();\n        $oldCW     = $settings[&#39;co_worker&#39;];\n        $oldClient = $settings[&#39;client&#39;];\n\n        $co_worker[&#39;create_message&#39;]         = ( isset( $oldCW[&#39;create_message&#39;] ) &amp;&amp; $oldCW[&#39;create_message&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;view_private_message&#39;]   = ( isset( $oldCW[&#39;msg_view_private&#39;] ) &amp;&amp; $oldCW[&#39;msg_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;create_list&#39;]            = ( isset( $oldCW[&#39;create_todolist&#39;] ) &amp;&amp; $oldCW[&#39;create_todolist&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;view_private_list&#39;]      = ( isset( $oldCW[&#39;tdolist_view_private&#39;] ) &amp;&amp; $oldCW[&#39;tdolist_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;create_task&#39;]            = ( isset( $oldCW[&#39;create_todo&#39;] ) &amp;&amp; $oldCW[&#39;create_todo&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;view_private_task&#39;]      = ( isset( $oldCW[&#39;todo_view_private&#39;] ) &amp;&amp; $oldCW[&#39;todo_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;create_milestone&#39;]       = ( isset( $oldCW[&#39;create_milestone&#39;] ) &amp;&amp; $oldCW[&#39;create_milestone&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;view_private_milestone&#39;] = ( isset( $oldCW[&#39;milestone_view_private&#39;] ) &amp;&amp; $oldCW[&#39;milestone_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;create_file&#39;]            = ( isset( $oldCW[&#39;upload_file_doc&#39;] ) &amp;&amp; $oldCW[&#39;upload_file_doc&#39;] == &#39;yes&#39; ) ? true : false;\n        $co_worker[&#39;view_private_file&#39;]      = ( isset( $oldCW[&#39;file_view_private&#39;] ) &amp;&amp; $oldCW[&#39;file_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        \n        $client[&#39;create_message&#39;]         = ( isset( $oldClient[&#39;create_message&#39;] ) &amp;&amp; $oldClient[&#39;create_message&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;view_private_message&#39;]   = ( isset( $oldClient[&#39;msg_view_private&#39;] ) &amp;&amp; $oldClient[&#39;msg_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;create_list&#39;]            = ( isset( $oldClient[&#39;create_todolist&#39;] ) &amp;&amp; $oldClient[&#39;create_todolist&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;view_private_list&#39;]      = ( isset( $oldClient[&#39;tdolist_view_private&#39;] ) &amp;&amp; $oldClient[&#39;tdolist_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;create_task&#39;]            = ( isset( $oldClient[&#39;create_todo&#39;] ) &amp;&amp; $oldClient[&#39;create_todo&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;view_private_task&#39;]      = ( isset( $oldClient[&#39;todo_view_private&#39;] ) &amp;&amp; $oldClient[&#39;todo_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;create_milestone&#39;]       = ( isset( $oldClient[&#39;create_milestone&#39;] ) &amp;&amp; $oldClient[&#39;create_milestone&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;view_private_milestone&#39;] = ( isset( $oldClient[&#39;milestone_view_private&#39;] ) &amp;&amp; $oldClient[&#39;milestone_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;create_file&#39;]            = ( isset( $oldClient[&#39;upload_file_doc&#39;] ) &amp;&amp; $oldClient[&#39;upload_file_doc&#39;] == &#39;yes&#39; ) ? true : false;\n        $client[&#39;view_private_file&#39;]      = ( isset( $oldClient[&#39;file_view_private&#39;] ) &amp;&amp; $oldClient[&#39;file_view_private&#39;] == &#39;yes&#39; ) ? true : false;\n\n\n        $newSetings = [\n            &#39;co_worker&#39; =&gt; $co_worker,\n            &#39;client&#39;    =&gt; $client\n        ];\n\n        $this-&gt;save_object( new Settings, [\n            &#39;key&#39;        =&gt; &#39;capabilities&#39;,\n            &#39;value&#39;      =&gt; $newSetings,\n            &#39;project_id&#39; =&gt; $newProject-&gt;id,\n            &#39;created_by&#39; =&gt; $newProject-&gt;created_by,\n            &#39;updated_by&#39; =&gt; $newProject-&gt;updated_by,\n            &#39;created_at&#39;  =&gt; $newProject-&gt;created_at,\n            &#39;updated_at&#39;  =&gt; $newProject-&gt;updated_at,\n        ] );\n    }\n\n    function set_bp_group( $oldProjectId, $newProject ) {\n        $group_id = get_post_meta( $oldProjectId, &#39;_bp_group_id&#39;, true );\n        if ( empty( $group_id )) {\n            return ;\n        }\n\n        $metaObj = $this-&gt;save_object( new Meta, [\n            &#39;entity_id&#39;   =&gt; $group_id,\n            &#39;entity_type&#39; =&gt; &#39;pm_buddypress&#39;,\n            &#39;meta_key&#39;    =&gt; &#39;group_id&#39;,\n            &#39;meta_value&#39;  =&gt; $group_id,\n            &#39;project_id&#39;  =&gt; $newProject-&gt;id,\n            &#39;created_by&#39;  =&gt; $newProject-&gt;created_by,\n            &#39;updated_by&#39;  =&gt; $newProject-&gt;updated_by,\n            &#39;created_at&#39;  =&gt; $newProject-&gt;created_at,\n            &#39;updated_at&#39;  =&gt; $newProject-&gt;updated_at,\n        ] );\n\n    }\n\n    function get_kanboard( $oldProjectId, $newProject ) {\n        $sections    = get_post_meta( $oldProjectId, &#39;_custom_section&#39;, true );\n        $newSections = array();\n\n        if( empty( $sections ) || !is_array( $sections ) ) {\n            return ;\n        }\n\n        foreach( $sections as $section ) {\n            $newBoard = $this-&gt;save_object( new Board, [\n                &#39;title&#39;       =&gt; $section[&#39;name&#39;],\n                &#39;description&#39; =&gt; null,\n                &#39;order&#39;       =&gt; $section[&#39;order&#39;],\n                &#39;type&#39;        =&gt; &#39;kanboard&#39;,\n                &#39;project_id&#39;  =&gt; $newProject-&gt;id,\n                &#39;created_by&#39;  =&gt; $newProject-&gt;created_by,\n                &#39;updated_by&#39;  =&gt; $newProject-&gt;updated_by,\n                &#39;created_at&#39;  =&gt; $newProject-&gt;created_at,\n                &#39;updated_at&#39;  =&gt; $newProject-&gt;updated_at,\n            ]);\n            $newSections[$section[&#39;section_id&#39;]] = $newBoard-&gt;id;\n        }\n        $this-&gt;kanboard_section[$newProject-&gt;id] = $newSections;\n    }\n\n    function gantt_upgrate() {\n        $gantt = false;\n\n        if ( \n            function_exists(&#39;pm_pro_is_module_inactive&#39;) \n                &amp;&amp; \n            pm_pro_is_module_inactive(&#39;gantt/gantt.php&#39;) \n        ) {\n            pm_pro_activate_module(&#39;gantt/gantt.php&#39;);\n            $gantt = true;\n        }\n\n        $task_relation = [];\n        $tasks = get_site_option( &#39;pm_task_migration&#39; );\n\n        foreach ( $tasks as $key =&gt; $value ) {\n            $task_relation[$value[&#39;old_task_id&#39;]] = $value[&#39;new_task_id&#39;];\n        }\n        $old_task_links = wp_list_pluck( $tasks, &#39;old_task_id&#39; );\n\n        if( is_array( $tasks ) ){\n            foreach ( $tasks as $task_obj ) {\n                $new =  intval( $task_obj[&#39;new_task_id&#39;] );\n                $old =  intval( $task_obj[&#39;old_task_id&#39;] );\n                $links = get_post_meta( $old, &#39;_link&#39;, true );\n                if( empty( $links ) ) {\n                    continue ;\n                }\n                \n                foreach ( $links as $link ) {\n                    if ( in_array( $link, $old_task_links ) ) {\n                        $this-&gt;save_object( new Gantt, [\n                            &#39;source&#39; =&gt; $new,\n                            &#39;target&#39; =&gt; $task_relation[$link],\n                            &#39;type&#39;   =&gt; 1,\n                        ]);\n                    }\n                }\n            }\n        }\n\n        if ( $gantt) {\n            pm_pro_deactivate_module(&#39;gantt/gantt.php&#39;);\n        }\n    }\n\n\n    function get_activity( $oldProjectId, $newProjectId, $discuss, $tasklist, $tasks, $comments ) {\n        if( !$oldProjectId ) {\n            return ;\n        }\n        global $wpdb;\n        $activities = $wpdb-&gt;get_results( &quot;SELECT * FROM $wpdb-&gt;comments WHERE  comment_post_ID = {$oldProjectId} AND comment_type=&#39;cpm_activity&#39; ORDER BY `comment_ID` ASC&quot;, ARRAY_A );\n        \n        foreach ( $activities as $activity ) {\n\n            list( $attr, $newCntent ) = $this-&gt;get_attr_array( $activity[&#39;comment_content&#39;] );\n            $meta                     = [ &#39;text&#39; =&gt; $newCntent ];\n            $resource_type            = &quot;&quot;;\n            $resource_id              = 0;\n\n            foreach ( $attr as $key =&gt; $value ) {\n\n                if( !empty( $value[&#39;title&#39;] ) ) {\n                    $title = $value[&#39;title&#39;];\n                }else {\n                    $title = &#39;&#39;;\n                }\n\n                switch ( $key ) {\n                   \n                    case &#39;cpm_msg_url&#39;:\n                        if ( empty( $discuss[$value[&#39;id&#39;]] ) ) {\n                            break;\n                        }\n\n                        $resource_id                    = $discuss[$value[&#39;id&#39;]];\n                        $resource_type                  = &#39;discussion_board&#39;;\n                        $meta[&#39;discussion_board_title&#39;] = $title;\n\n                        break;\n                    case &#39;cpm_tasklist_url&#39;:\n                        if ( empty( $tasklist[$value[&#39;id&#39;]] ) ) {\n                            break;\n                        }\n                        \n                        $resource_id             = $tasklist[$value[&#39;id&#39;]];\n                        $resource_type           = &#39;task_list&#39;;\n                        $meta[&#39;task_list_title&#39;] = $title;\n\n                        break;\n                    case &#39;cpm_task_url&#39;: \n                        if ( empty( $tasks[$value[&#39;id&#39;]] ) ) {\n                            break;\n                        }                        \n                        $resource_id        = $tasks[$value[&#39;id&#39;]];\n                        $resource_type      = &#39;task&#39;;\n                        $meta[&#39;task_title&#39;] = $title;\n\n                        break;\n                    case &#39;cpm_comment_url&#39;:\n                \n                        $resource_id        = $value[&#39;id&#39;];\n                        $resource_type      = &#39;comment&#39;;\n                        $meta[&#39;comment_id&#39;] = $value[&#39;id&#39;];\n\n                        break;\n                    case &#39;cpm_user_url&#39;:\n                        break;  \n                       \n                }\n            }\n\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;          =&gt; &#39;activity&#39;,\n                &#39;activity&#39;      =&gt; $activity,\n                &#39;resource_id&#39;   =&gt; $resource_id,\n                &#39;resource_type&#39; =&gt; $resource_type,\n                &#39;meta&#39;          =&gt; $meta,\n                &#39;newProjectId&#39;  =&gt; $newProjectId\n            ];\n        }\n    }\n\n    function created_activity( $activity, $resource_id, $resource_type, $meta, $newProjectId ) {\n        $this-&gt;save_object( new Activity, [\n            &#39;actor_id&#39;      =&gt; $activity[&#39;user_id&#39;],\n            &#39;action&#39;        =&gt; &#39;cpm_migration&#39;,\n            &#39;action_type&#39;   =&gt; &#39;migrated&#39;,\n            &#39;resource_id&#39;   =&gt; $resource_id,\n            &#39;resource_type&#39; =&gt; $resource_type,\n            &#39;meta&#39;          =&gt; $meta,\n            &#39;project_id&#39;    =&gt; $newProjectId,\n            &#39;created_at&#39;    =&gt; $activity[&#39;comment_date&#39;],\n            &#39;updated_at&#39;    =&gt; $activity[&#39;comment_date&#39;],\n        ] );\n    }\n\n\n    function get_attr_array( $str ) {\n        $attr = [];\n        $arr  = [\n            &#39;cpm_msg_url&#39;      =&gt; &#39;{{meta.discussion_board_title}}&#39;,\n            &#39;cpm_user_url&#39;     =&gt; &#39;{{actor.data.display_name}}&#39;,\n            &#39;cpm_task_url&#39;     =&gt; &#39;{{meta.task_title}}&#39;,\n            &#39;cpm_tasklist_url&#39; =&gt; &#39;{{meta.task_list_title}}&#39;,\n            &#39;cpm_comment_url&#39;  =&gt; &#39;{{meta.comment_id}}&#39;\n        ];\n        $text = $str;\n        $pattern = get_shortcode_regex();\n            \n        $sdf     = preg_replace_callback( &quot;/$pattern/s&quot;, function ( $match ) use ( &amp;$attr, $arr, &amp;$text ) {\n\n            $text = str_replace($match[0], $arr[$match[2]], $text );\n\n            $attr[$match[2]] = shortcode_parse_atts( $match[3] );\n\n            if( empty( $attr[$match[2]][&#39;title&#39;] )){\n                if( strpos($match[0], &#39;title=&#39;) !== false ){\n                   $title = substr( $match[0], strpos($match[0], &#39;title=&#39;) + 7, -2);\n                   $title = preg_replace(&quot;/[\\&quot;\\&#39;\\}\\]]/m&quot;, &#39;&#39; , $title);\n                   $attr[$match[2]][&#39;title&#39;] = $title;\n                }\n            }\n        }, $str );\n\n        return array($attr, $text);\n    }\n\n    function get_time_tracker( $oldProjectId, $newProjectID, $taskList, $tasks ) {\n        if ( !$oldProjectId ){\n            return ;\n        }\n\n        if(!class_exists( &#39;WeDevs\\PM_Pro\\Modules\\time_tracker\\src\\Models\\Time_Tracker&#39; ) ) {\n            return ;\n        }\n\n        if( function_exists(&#39;pm_pro_is_module_inactive&#39;) &amp;&amp; pm_pro_is_module_inactive(&#39;time_tracker/time_tracker.php&#39;) ) {\n            return ;\n        }\n\n        global $wpdb;\n        $old_task_id = key($tasks);\n        $table       = $wpdb-&gt;prefix. &#39;cpm_time_tracker&#39;;\n        $timetracker = $wpdb-&gt;get_results( &quot;SELECT * FROM {$table} WHERE task_id = {$old_task_id} AND  project_id = {$oldProjectId}&quot;, ARRAY_A );\n        \n        if ( is_wp_error( $timetracker ) ) {\n            return;\n        }\n        \n        foreach( $timetracker as $time ){\n            $this-&gt;pm_queue_data[] = [\n                &#39;type&#39;       =&gt; &#39;time_tracker&#39;,\n                &#39;user_id&#39;    =&gt; $time[&#39;user_id&#39;],\n                &#39;project_id&#39; =&gt; $newProjectID,\n                &#39;list_id&#39;    =&gt; $taskList[$time[&#39;tasklist_id&#39;]],\n                &#39;task_id&#39;    =&gt; $tasks[$time[&#39;task_id&#39;]],\n                &#39;start&#39;      =&gt; $time[&#39;start&#39;],\n                &#39;stop&#39;       =&gt; $time[&#39;stop&#39;],\n                &#39;total&#39;      =&gt; $time[&#39;total&#39;],\n                &#39;run_status&#39; =&gt; $time[&#39;run_status&#39;] == &#39;no&#39; ? 0 : 1 \n            ];\n            // $this-&gt;save_object( new Time_Tracker, [\n            //     &#39;user_id&#39;    =&gt; $time[&#39;user_id&#39;],\n            //     &#39;project_id&#39; =&gt; $newProjectID,\n            //     &#39;list_id&#39;    =&gt; $taskList[$time[&#39;tasklist_id&#39;]],\n            //     &#39;task_id&#39;    =&gt; $tasks[$time[&#39;task_id&#39;]],\n            //     &#39;start&#39;      =&gt; $time[&#39;start&#39;],\n            //     &#39;stop&#39;       =&gt; $time[&#39;stop&#39;],\n            //     &#39;total&#39;      =&gt; $time[&#39;total&#39;],\n            //     &#39;run_status&#39; =&gt; $time[&#39;run_status&#39;] == &#39;no&#39; ? 0 : 1 \n            // ] );\n        }\n    }\n\n    function create_time_tracker( $time ) {\n        \n        $this-&gt;save_object( new Time_Tracker, [\n            &#39;user_id&#39;    =&gt; $time[&#39;user_id&#39;],\n            &#39;project_id&#39; =&gt; $time[&#39;project_id&#39;],\n            &#39;list_id&#39;    =&gt; $time[&#39;list_id&#39;],\n            &#39;task_id&#39;    =&gt; $time[&#39;task_id&#39;],\n            &#39;start&#39;      =&gt; $time[&#39;start&#39;],\n            &#39;stop&#39;       =&gt; $time[&#39;stop&#39;],\n            &#39;total&#39;      =&gt; $time[&#39;total&#39;],\n            &#39;run_status&#39; =&gt; $time[&#39;run_status&#39;] \n        ] );\n    }\n\n    function add_file( $arr ) {\n        return $this-&gt;save_object( new File, $arr );\n    }\n\n    function add_board( $post , $board_type, $newProjectID ) {\n        $newBoard = $this-&gt;save_object( new Board, [\n            &#39;title&#39;       =&gt; $post[&#39;post_title&#39;],\n            &#39;description&#39; =&gt; $post[&#39;post_content&#39;],\n            &#39;order&#39;       =&gt; $post[&#39;menu_order&#39;],\n            &#39;type&#39;        =&gt; $board_type,\n            &#39;project_id&#39;  =&gt; $newProjectID,\n            &#39;created_by&#39;  =&gt; $post[&#39;post_author&#39;],\n            &#39;updated_by&#39;  =&gt; $post[&#39;post_author&#39;],\n            &#39;created_at&#39;  =&gt; $post[&#39;post_date&#39;],\n            &#39;updated_at&#39;  =&gt; $post[&#39;post_modified&#39;],\n        ]);\n\n        return $newBoard;\n    }\n\n    function add_meta( $meta , $object, $newProjectID, $entity_type = null ) {\n        $meta_ids = [];\n        foreach ( $meta as $key =&gt; $value ) {\n            if( empty( $value ) ){\n                continue ;\n            }\n            $metaObj = $this-&gt;save_object( new Meta, [\n                &#39;entity_id&#39;   =&gt; $object-&gt;id,\n                &#39;entity_type&#39; =&gt; $entity_type !== null? $entity_type : $object-&gt;type,\n                &#39;meta_key&#39;    =&gt; $key,\n                &#39;meta_value&#39;  =&gt; $value,\n                &#39;project_id&#39;  =&gt; $newProjectID,\n                &#39;created_by&#39;  =&gt; $object-&gt;created_by,\n                &#39;updated_by&#39;  =&gt; $object-&gt;updated_by,\n                &#39;created_at&#39;  =&gt; $object-&gt;created_at,\n                &#39;updated_at&#39;  =&gt; $object-&gt;updated_at,\n            ] );\n\n            $meta_ids[] = $metaObj-&gt;id;\n        }\n\n        return $meta_ids;\n    }\n\n    function set_settings() {\n        $genral          = get_site_option( &#39;cpm_general&#39;, array() );\n        $mail            = get_site_option( &#39;cpm_mails&#39;, array() );\n        $page            = get_site_option( &#39;cpm_page&#39;, array() );\n        $woo_projects    = get_site_option( &#39;cpmwoo_settings&#39;, array() );\n        $cpm_integration = get_site_option( &#39;cpm_integration&#39;, array() );\n        $projects        = get_site_option( &#39;pm_upgrade&#39;, array() );\n        $invoice         = get_site_option( &#39;cpm_invoice&#39;, array() );\n        $newSettings     = array();\n        $woo_project     = array();\n        \n        if ( is_array( $woo_projects ) &amp;&amp; !empty( $woo_projects ) ){\n            foreach ( $woo_projects as $wp ) {\n                $role = [];\n                if ( is_array( $wp[&#39;role&#39;] ) &amp;&amp; !empty( $wp[&#39;role&#39;] ) ) {\n                    foreach ( $wp[&#39;role&#39;] as $key =&gt; $value ) {\n                        $role[] = [\n                            &#39;user_id&#39; =&gt; $key,\n                            &#39;role_id&#39; =&gt; $value !== &#39;co_worker&#39; ? 1 : 2,\n                        ];\n                    }\n                }\n                \n                $woo_project[] = [\n                    &#39;action&#39;      =&gt; $wp[&#39;type&#39;],\n                    &#39;product_ids&#39; =&gt; array($wp[&#39;product_id&#39;]),\n                    &#39;project_id&#39;  =&gt; $projects[$wp[&#39;project_id&#39;]],\n                    &#39;assignees&#39;   =&gt; $role\n                ];\n            }\n        }\n        if( isset( $genral[&#39;project_manage_role&#39;] ) ) {\n            $newSettings[&#39;managing_capability&#39;] = array_values( $genral[&#39;project_manage_role&#39;] );\n        }\n        if( isset( $genral[&#39;project_create_role&#39;] ) ) {\n            $newSettings[&#39;project_create_capability&#39;] = array_values( $genral[&#39;project_create_role&#39;] );\n        }\n        if( !empty( $woo_project ) ) {\n            $newSettings[&#39;woo_project&#39;] = $woo_project;\n        }\n\n        if( !empty( $genral ) ){\n            $this-&gt;set_new_setting( $newSettings, &#39;upload_limit&#39;, $genral, &#39;upload_limit&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;project_per_page&#39;, $genral, &#39;pagination&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;list_per_page&#39;, $genral, &#39;show_todo&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;list_show&#39;, $genral, &#39;todolist_show&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;incomplete_tasks_per_page&#39;, $genral, &#39;show_incomplete_tasks&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;complete_tasks_per_page&#39;, $genral, &#39;show_completed_tasks&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;task_start_field&#39;, $genral, &#39;task_start_field&#39;, &#39;on&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;daily_digest&#39;, $genral, &#39;daily_digest&#39;, &#39;on&#39; );\n        }\n\n        if ( !empty($mail) ) {\n            $this-&gt;set_new_setting( $newSettings, &#39;from_email&#39;, $mail, &#39;email_from&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;link_to_backend&#39;, $mail, &#39;email_url_link&#39;, &#39;backend&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;email_type&#39;, $mail, &#39;email_type&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;enable_bcc&#39;, $mail, &#39;email_bcc_enable&#39;, &#39;on&#39; );\n        }\n\n        if( !empty( $page ) ) {\n            $this-&gt;set_new_setting( $newSettings, &#39;project&#39;, $page, &#39;project&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;my_task&#39;, $page, &#39;my_task&#39; );\n            $this-&gt;set_new_setting( $newSettings, &#39;calendar&#39;, $page, &#39;calendar&#39; );\n        }\n\n        if ( !empty( $cpm_integration ) ) {\n            $this-&gt;set_new_setting( $newSettings, &#39;after_order_complete&#39;, $cpm_integration, &#39;woo_duplicate&#39;, &#39;paid&#39; );\n        }  \n\n        if ( !empty( $invoice ) ) {\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;theme_color&#39;, $invoice, &#39;theme_color&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;currency_code&#39;, $invoice, &#39;currency&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;paypal&#39;, $invoice, &#39;payment_gateway&#39;, &#39;paypal&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;paypal_mail&#39;, $invoice, &#39;paypal_email&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;sand_box_mode&#39;, $invoice, &#39;paypal_sand_box&#39;, &#39;on&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;paypal_instruction&#39;, $invoice, &#39;gate_instruct_paypal&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;organization&#39;, $invoice, &#39;organization&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;address_line_1&#39;, $invoice, &#39;address_line_1&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;address_line_2&#39;, $invoice, &#39;address_line_2&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;city&#39;, $invoice, &#39;city&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;sate_province&#39;, $invoice, &#39;state&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;zip_code&#39;, $invoice, &#39;zip&#39; );\n            $this-&gt;set_new_setting( $newSettings[&#39;invoice&#39;], &#39;country_code&#39;, $invoice, &#39;country&#39; );\n        }\n\n        foreach ( $newSettings as $key =&gt; $value ) {\n            $settings = Settings::firstOrCreate([\n                &#39;key&#39; =&gt; $key\n            ]);\n            $settings-&gt;update_model( [&#39;key&#39;=&gt;$key, &#39;value&#39;=&gt; $value] );\n        }\n        \n    }\n\n    function set_new_setting( &amp;$settings, $newkey, $oldsettings, $oldkey, $willtrue = null ) {\n\n        if( !isset( $oldsettings[$oldkey] ) || empty( $oldsettings[$oldkey] ) ) {\n            return ;\n        }\n        if( $willtrue != null ) {\n            $settings[$newkey] = $oldsettings[$oldkey] == $willtrue ? true : false;\n        }\n        $settings[$newkey] = $oldsettings[$oldkey];\n    }\n\n    function migrate_category() {\n        global $wpdb;\n        $terms = get_terms( \n            [\n                &#39;taxonomy&#39; =&gt; &#39;cpm_project_category&#39;,\n                &#39;hide_empty&#39; =&gt; false,\n            ]\n        );\n\n        $categories = [];\n\n        if ( is_wp_error( $terms ) ) {\n            return;\n        }\n\n        $object = wp_list_pluck($terms, &#39;term_taxonomy_id&#39; );\n        $object = implode(&#39;,&#39;, $object);\n        \n        $terms_releation = $wpdb-&gt;get_results( &quot;SELECT * FROM {$wpdb-&gt;term_relationships} WHERE  term_taxonomy_id in({$object})&quot;, ARRAY_A );\n        $terms_releation = collect( $terms_releation );\n\n        foreach ( $terms as $term ) {\n            $cat = Category::firstOrCreate( [\n                &#39;title&#39;            =&gt; $term-&gt;name , \n                &#39;description&#39;      =&gt; $term-&gt;description, \n                &#39;categorible_type&#39; =&gt;&#39;project&#39;,\n            ]);\n            $projects = get_site_option( &quot;pm_db_migration&quot;, [] );\n\n            $pterm = $terms_releation-&gt;where( &#39;term_taxonomy_id&#39;, $term-&gt;term_taxonomy_id )-&gt;pluck(&#39;object_id&#39;)-&gt;all();\n\n            $arr = array_filter( $projects, function( $key ) use ( $pterm ){\n                return in_array( $key, $pterm );\n            }, ARRAY_FILTER_USE_KEY);\n\n            $cat-&gt;projects()-&gt;attach( array_values( $arr ) );\n            $categories[$term-&gt;term_taxonomy_id] = $cat-&gt;id;\n        }\n        return $categories;\n    }\n\n    /**\n     * save object from model\n     * @param  object $object new model\n     * @param  array $arr    model data\n     * @return object         new model\n     */\n    function save_object( $object,  $arr ) {\n        foreach ($arr as $key =&gt; $value) {\n            $object-&gt;{$key} = $value;\n        }\n\n        $object-&gt;unsetEventDispatcher();\n\n        if( $object-&gt;save() ) {\n            return $object;\n        } \n    }\n    \n}";
        // Using jquery way of decoding the html content.
        // Tried to use '_' version of unescape method but it
        // did not decode encoded version of apostrophe (')
        // where the code is &#39;
        var htmlContent = $("<div/>").html(file_content).text();

        var fileName = "Upgrade_2_0.php";
        var editAreaEl = "";
        var lastResizeTime = 0;
        var lastResizeRequestTime = 0;

        function load_EditArea(workingContent) {
            workingContent = workingContent;
            if(USE_LEGACY_EDITOR){
                showAceEditorElements(false);

                editAreaEl = 'legacy_codewindow';
                CODEWINDOW = DOM.get(editAreaEl);
                editAreaLoader.show(editAreaEl);
                loadLegacyEditor(editAreaEl, workingContent);
            } else {
                editAreaLoader.hide(editAreaEl);

                editAreaEl = 'codewindow';
                CODEWINDOW = DOM.get(editAreaEl);
                showAceEditorElements(true);
                loadAceEditor(editAreaEl, workingContent);
            }
        }

        function showAceEditorElements(show){
            if(show){
                $(".show-ace-editor").show();
            } else {
                $(".show-ace-editor").hide();
            }
        }

        function loadLegacyEditor(editAreaId, editContent){
            // Setting up the ids in js/edit_area_resizer.js file to
            // use it for resizing purposes.
            setElementIds(editAreaId);
            var EditArea_config = {
                id: editAreaEl,
                start_highlight: true,
                allow_resize: "both",
                allow_toggle: false,
                language: "en",
                toolbar: "search, go_to_line, |, undo, redo, |, select_font, |, syntax_selection, |, change_smooth_selection, highlight, reset_highlight, word_wrap, |, help",
                syntax: "php",
                word_wrap: true
            };
            editAreaLoader.setValue(editAreaId, editContent);

            editAreaLoader.init(EditArea_config);
            doResizeSoon();
        }

        function loadAceEditor(editAreaEl, editContent){
            ace_editor = ace.edit(editAreaEl);
            // The line below is added to disable a
            // warning message as required by ace editor
            // script.
            ace_editor.$blockScrolling = Infinity;
            ace_editor.focus();

            var editSession = ace.createEditSession(editContent);
            ace_editor.setSession(editSession);
            if(typeof(editSession) !== "undefined"){
                var defaultFontSize = 13;
                // Load the modelist extension to identify the file
                // type of the given file and open the file in that
                // editor mode.
                var modelist = ace.require("ace/ext/modelist");
                var modeObj = modelist.getModeForPath(fileName);

                ace_editor.setOptions({
                    "fontSize": defaultFontSize,
                    "mode": modeObj.mode,
                    "theme": "ace/theme/chrome"
                });
                toggleWordWrap();

                // Fill mode list dropdown in the toolbar.
                var $modeEl = $('#ddlModes');
                fillModesDropdown($modeEl, modelist);
                $modeEl.val(modeObj.name);
                // Bind change event.
                $modeEl.change(function(){
                    var selectedMode = $modeEl.find( "option:selected" ).first().val();
                    ace_editor.getSession().setMode(modelist.modesByName[selectedMode].mode);
                });

                // Fill font size dropdown.
                var $fontEl = $('#ddlFontSizes');
                fillFontsDropdown($fontEl);
                $fontEl.val(defaultFontSize);
                // Bind change event.
                $fontEl.change(function(){
                    var selectedSize = parseInt($fontEl.find( "option:selected" ).first().val());
                    ace_editor.setFontSize(selectedSize);
                });
            }
        }

        function fillFontsDropdown($el) {
            var arr = [10, 11, 12, 13, 14, 16, 18, 20, 24].map(function(size){
                return {val: size, text: size + "px"};
            });
            arr.forEach(function(val){
                $el.append($("<option>", val));
            });
        }

        function fillModesDropdown($el, modeList) {
            var arr = modeList.modes.map(function(oMode){
                return {val: oMode.name, text: oMode.caption};
            });
            arr.forEach(function(val){
                $el.append($("<option>", val));
            });
        }

        function toolbarActions(action){
            switch(action){
                case "search":
                ace_editor.execCommand("find");
                break;
                case "goto":
                ace_editor.execCommand("gotoline");
                break;
                case "undo":
                ace_editor.undo();
                break;
                case "redo":
                ace_editor.redo();
                break;
                case "linewrap":
                toggleWordWrap();
                break;
            }
        }

        function toggleWordWrap() {
            var btnEl = document.querySelector("#btnLineWrap");
            if(btnEl && btnEl.classList.contains("active")){
                ace_editor.setOption("wrap", false);
                btnEl.classList.remove("active");
            } else {
                ace_editor.setOption("wrap", 80);
                btnEl.classList.add("active");
            }
        }

        /*
         * This function detects if the browser is in a mobile
         * environment.
         * Note: This is used to open the editor in legacy editor mode
         * until Ace editor comes with the fixes for issues described in
         * ZC-2558.
        */
        function detectmobile() {
         if( navigator.userAgent.match(/Android/i)
         || navigator.userAgent.match(/webOS/i)
         || navigator.userAgent.match(/iPhone/i)
         || navigator.userAgent.match(/iPad/i)
         || navigator.userAgent.match(/iPod/i)
         || navigator.userAgent.match(/BlackBerry/i)
         || navigator.userAgent.match(/Windows Phone/i)
         ){
            return true;
          }
         else {
            return false;
          }
        }

        function toggle_EditArea(link) {
            var workingContent = "";
            if(USE_LEGACY_EDITOR){
                USE_LEGACY_EDITOR = false;
                // send working content to not loose working data
                // when user switches between two editors.
                workingContent = (editAreaLoader) ? editAreaLoader.getValue(editAreaEl) : "";
            } else {
                USE_LEGACY_EDITOR = true;
                // Reset the word wrap
                toggleWordWrap();
                // send working content to not loose working data
                // when user switches between two editors.
                workingContent = (ace_editor) ? ace_editor.getSession().getValue() : "";
            }
            toggleSwitchButtonAttr(link);
            load_EditArea(workingContent);
        }

        function toggleSwitchButtonAttr(btnEl) {
            var $switchButton = $(btnEl);
            if(USE_LEGACY_EDITOR){
                $switchButton.text("Use latest editor").prop("title", "Switch to latest editor.");
            } else {
                $switchButton.text("Use legacy editor").prop("title", "Switch to legacy editor.");
            }
        }

        var CODEWINDOW;
        var ace_editor;

        EVENT.throwErrors = true;

        YAHOO.util.Event.addListener(window, "load", function(){
            savedContent = htmlContent;
            if(detectmobile()){
                USE_LEGACY_EDITOR = true;
            }
            toggleSwitchButtonAttr(DOM.get("switch_editor_control"));
            load_EditArea(savedContent);
        });
        $(window).resize(function(e) {
            doResize();
        });
        </script>

    

<div id="cjt_dynamicnotice_container" class="cjt-dynamicnotice-container cjt-notice-container"></div></body></html>